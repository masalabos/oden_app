var e=Object.defineProperty,t=(t,n,o)=>(((t,n,o)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o})(t,"symbol"!=typeof n?n+"":n,o),o);import{D as n,a as o,i as s,p as a,u as l,b as i,r as c,d as r,c as d,e as u,o as m,f as p,g as h,h as g,j as _,k as v,t as b,l as f,F as k,m as w,w as y,n as x,q as E,s as $,v as C,x as M,y as S,z as j,A as O,B as L,C as T,E as I,G as D,H as N,I as A,J as F,R,K as P,L as B,M as H,T as V,N as J,O as U,P as K,Q as z,_ as q,S as Y,U as W}from"./vendor.7270aa21.js";class G{constructor(){this.id=-1,this.content="",this.path="",this.title="",this.group="",this.atime=Date(),this.ctime=Date(),this.tags=[],this.htags=[]}set(e,t="",n=[],o=!1){""!=t&&(this.path=t),n!=[]&&(this.tags=n),this.content=e;const s=this.get_time();this.atime=s,1==o&&(this.ctime=s)}set_default(e){this.path=e,this.content="",this.tags=[];const t=this.get_time();this.atime=t,this.ctime=t}copy(e){Object.assign(this,e)}duplicate(e,t=""){const n=new G;return n.copy(this),n.content=e,n.path=t,n.update_contentEx(),n.update_time(),n}update_content(e){this.content=e,this.atime=this.get_time(),this.update_contentEx()}update_contentEx(){this.tags=this.build_tag(this.content)}get_time(){return this.cnv_time(new Date)}cnv_time(e){const t=e=>`00${e}`.slice(-2);return`${e.getFullYear()}/${t(e.getMonth()+1)}/${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`}update_time(){this.atime=this.cnv_time(new Date(this.atime)),this.ctime=this.cnv_time(new Date(this.ctime))}static rebuild_body(e){return e}update_tag(){this.tags=this.build_tag(this.content)}build_tag(e){console.log("[build_tag]");const t=[],n=[0,0,0,0,0],o=e.split(/\r\n|\n|\r/);for(let s=0;s<o.length;s++){if(-1!=o[s].search(/^\s*#/)){const e=o[s].split(" "),a=e[0].length;e.shift();const l=e.join(" ");t.push({text:l,line:s,tag:a,num:n[a]}),n[a]++}}return t}split(e){const t=[],n=this.content.split(/\r\n|\n|\r/),o=this.tags.filter((function(t){return t.tag==e})),s=[],a=n.length;for(var l=0;l<o.length;l++){const e=o[l].line;s.push({start:e,end:a,title:o[l].text}),0!=l&&(s[l-1].end=e-1)}const i=this.path.indexOf(".md")?this.path.slice(0,-3):this.path;return s.reverse(),s.forEach((e=>{const o=n.splice(e.start,e.end).join("\r\n"),s=this.duplicate(o,`${i}/${e.title}`);t.push(s)})),t.reverse(),t}}class Q extends n{constructor(){super("OdenDB"),this.version(2).stores({viewer:"key, ctime"}),this.viewer=this.table("viewer")}}class X{constructor(e){this.db=new Q,this.ctime="",this.atime="",this.getStrageEx=async()=>await this.getAll(),this.read=async e=>{const t=await this.dbx.get(e);return null!=t?t.data:null},this.write=async(e,t)=>{const n=JSON.stringify(t);await this.dbx.put({key:e,data:n,ctime:this.set_time_DB()}),this.set_time_DB()},this.delete=async e=>{await this.dbx.delete(e),this.set_time_DB()},this.caller=e,this.dbx=this.db.viewer,this.getAll()}get_dbx(){return this.db.viewer}async getAll(){const e=[];return(await this.dbx.toArray()).forEach((t=>{e[t.key]=t.data})),this.atime=this.get_time_DB(),e}async sync_DB(){0==this.check_async_DB()&&await this.getAll()}check_async_DB(){return this.atime==this.get_time_DB()}set_time_DB(){const e=JSON.stringify(new Date);return localStorage.setItem("update_DB_time",e),this.atime=e,e}get_time_DB(){var e;return null!=(e=localStorage.getItem("update_DB_time"))?e:""}}class Z{constructor(e){this.write=(e,t)=>this.storeLS.write(e,t),this.delete=e=>this.storeLS.delete(e),this.rename=async(e,t)=>{console.log(`[rename] _key_org=${e}, _key_new=${t}`);const n=this.as(await this.get(e));return n.path=t,await this.write(t,n),await this.delete(e),n},this.split=async e=>{console.log(`[split] _key_org=${e}`);const t=this.as(await this.get(e)).split(1);return t.forEach((e=>{this.write(e.path,e)})),t},this.merge=(e,t)=>{console.log(`[merge] _path=${e}`);const n=new G;return n.set_default(e),n.update_content(t),this.write(e,n),n},this.as=e=>Object.assign(new G,e),this.sync_DB=()=>this.storeLS.sync_DB(),this._=e,this.storeLS=new X(this._)}async get(e){console.log(`[get] _key=${e}`);const t=await this.read(e);return null!=t?JSON.parse(t):this.create(e)}async exist(e){console.log(`[exist] _key=${e}`);return null!=await this.read(e)}async set(e,t){console.log(`[set] _key=${e}`);const n=this.as(await this.get(e));return""==n.path&&(n.path=e),n.update_content(t),this.write(e,n),n}async read(e){return await this.storeLS.read(e)}create(e){console.log(`[create] _key=${e}`);const t=new G;return null!=e&&(t.set_default(e),this.write(e,t)),t}}class ee{constructor(e){this._=e}async rebuildMenu(e=""){console.log("[rebuildMenu]");const t=await this._.mgrCache.getLstContent(e),n=this.buildMenu(t);return console.log(`${t.length}/${n.length}`),this._.contentEx.set("menu.json",JSON.stringify(n)),n}async getMenu(e){if(console.log(`[getMenu] _filter=${e}`),null!=e)return await this.rebuildMenu(e);{const e=await this._.contentEx.get("menu.json");return JSON.parse(e.content)}}buildMenu(e){return function(e){console.log("storeEx_index:buildMenuEx");const t=function(e){const t=new Set;return e.forEach((e=>{t.add(e.group)})),[...t]}(e);return e.reduce(((e,n)=>{if("menu.json"==n.path)return e;let o=n.group,s=n.title,a=`${o}/${s}`;return t.includes(a)&&(o=a,s=".index",a=`${o}/${s}`),e.push({key:a,group:o,title:s,path:n.path,atime:n.atime}),e}),[])}(e).sort(this.compare_group)}compare_group(e,t){let n=e.group,o=t.group;n==o&&(n=`${e.group}/${e.title}`,o=`${t.group}/${t.title}`);const s=n.toUpperCase(),a=o.toUpperCase();let l=0;return s>a?l=1:s<a&&(l=-1),l}}class te{static async read(e){console.log(`[read] filename=${e}`);const t=new URLSearchParams;return t.append("filename",e),te.post_cmdEx("load_file_md",t)}static write(e,t){console.log(`[write] filename=${e}`);const n=new URLSearchParams;return n.append("filename",e),n.append("source",t),te.post_cmdEx("save_file_md",n)}static async get_cmdEx(e){const t="http://localhost:5000/api/viewer/"+e;return console.log(`[store_RST:get_cmdEx] api=${t}`),o.get(t).then((e=>e.data)).catch((e=>{throw e.response.status}))}static async post_cmdEx(e,t){const n="http://localhost:5000/api/viewer/"+e;return console.log(`[store_RST:post_cmdEx] api=${n}`),o.post(n,t).then((e=>e.data)).catch((e=>{throw e.response.status}))}}class ne{constructor(e){this._=e}async restore(e,t){function n(e){e.forEach((e=>{const t=new G;t.copy(e),t.update_contentEx(),t.update_time(),o.write(t.path,t)}))}console.log("[importExport:restore]");const o=this._.contentEx;return new Promise((function(o,s){switch(e){case 0:!function(e,t){te.get_cmdEx("restore_contents").then((t=>{n(t),e(t)})).catch((e=>{console.log(e),t(null)}))}(o,s);break;case 1:!function(e,t,o){const s=new FileReader;s.onload=()=>{var e;console.log("onload");const o=null!=(e=s.result)?e:"",a=JSON.parse(o);n(a),t(a)},s.onerror=e=>{o("error")},s.readAsText(e)}(t,o,s)}}))}backup(e){console.log("[importExport:backup]");const t=new URLSearchParams;t.append("lstContent",JSON.stringify(e)),te.post_cmdEx("backup_contents",t).then((e=>console.log(e))).catch((e=>console.log(e)))}backupEx(e){console.log("[importExport:backupEx]");const t=new Blob([JSON.stringify(e)],{type:"text/plain"});console.log("createObjectURL");const n=document.createElement("a");n.download="lstData.json",n.href=URL.createObjectURL(t),n.click(),URL.revokeObjectURL(n.href)}}class oe{constructor(e){this.journal=async(e,t)=>{console.log("[journal]");const n=await this.geolocation();var o;return e.content+=(o=n,`\n## ${e.cnv_time(t)}\n${o}\n`),e},this.geolocation=()=>new Promise((e=>{let t="";navigator.geolocation?navigator.geolocation.getCurrentPosition((n=>{t=`- (Latitude,longitude)=(${n.coords.latitude},${n.coords.longitude})\n`,e(t)}),(n=>{switch(n.code){case 1:t="<li>位置情報の利用が許可されていません</li>";break;case 2:t="<li>デバイスの位置が判定できませんでした</li>";break;case 3:t="<li>タイムアウトが発生しました</li>"}e(t)})):(window.alert("<li>Geolocation APIが搭載されていないブラウザです。</li>"),e(t))})),this._=e}async path_rename(e,t,n){console.log(`_from=${e}, _to=${t}`);const o=this.collect_filename_by_group(e,n);for(let s=0;s<o.length;s++){const e=o[s],n=`${e[1]}/${e[0]}`,a=`${t}${e[2]}/${e[0]}`;await this._.contentEx.rename(n,a)}}async path_delete(e,t){console.log(`_path=${e}`);const n=this.collect_filename_by_group(e,t);for(let o=0;o<n.length;o++){const e=n[o],t=`${e[1]}/${e[0]}`;await this._.contentEx.delete(t)}}async path_merge(e,t,n){console.log(`_path=${e}`);const o=[],s=this.collect_filename_by_group(e,n);for(let l=0;l<s.length;l++){const e=s[l],t=`${e[1]}/${e[0]}`,n=await this._.contentEx.get(t);o.push(n.content)}const a=o.join("\r\n");return this._.contentEx.merge(t,a)}collect_filename_by_group(e,t){console.log(`[collect_filename_by_group] group=${e}`);const n=[],o=0!=e.length?1:0;return t.forEach(((t,s)=>{if(t.group==e){const s=t.group.substring(e.length+o);n.push([t.title,t.group,0!=s.length?`/${s}`:""])}})),n}}class se{constructor(e){this._=e}async getLstContent(e=""){console.log("[getLstContent]");const t=await this.buildLstContent();return""!=e?t.filter((t=>-1!=t.content.toLowerCase().indexOf(e))):t}async buildLstContent(){var e;console.log("[buildLstContent]");const t=e=>{var t,n;let o=e.path;""!=o&&null!=o||(o=`@test/${(new Date).toLocaleString()}`);const s=o.split("/");return e.title=null!=(t=s.pop())?t:".",e.group=null!=(n=s.join("/"))?n:"@test",e},n=await this._.contentEx.storeLS.getStrageEx(),o=[];for(const a of Object.keys(n))try{o.push(t(JSON.parse(null!=(e=n[a])?e:"")))}catch(s){console.log(`@ error key=${a},e=${s} - other error`)}return o}}class ae{constructor(){this.contentEx=new Z(this),this.mgrExchange=new ne(this),this.mgrEtc=new oe(this),this.mgrMenu=new ee(this),this.mgrCache=new se(this),console.log("[constructor]")}async cmd_getMenu(e=""){return this.mgrMenu.getMenu(e)}async cmd_load(e){return this.contentEx.get(e)}async cmd_create(e){return await this.contentEx.get(e),this.mgrMenu.rebuildMenu()}async cmd_split(e){return await this.contentEx.split(e),this.mgrMenu.rebuildMenu()}async cmd_save(e,t){return this.contentEx.set(e,t)}async cmd_delete(e){return await this.contentEx.delete(e),this.mgrMenu.rebuildMenu()}async cmd_rename(e,t){return await this.contentEx.rename(e,t),this.mgrMenu.rebuildMenu()}async cmd_exist(e){return this.contentEx.exist(e)}async cmd_backup(){const e=await this.mgrCache.buildLstContent();return this.mgrExchange.backup(e)}async cmd_backupEx(){const e=await this.mgrCache.buildLstContent();return this.mgrExchange.backupEx(e)}async cmd_restore(e,t){return await this.mgrExchange.restore(e,t),this.mgrMenu.rebuildMenu()}async cmd_rebuild(){return this.mgrMenu.rebuildMenu()}async cmd_path_rename(e,t){const n=await this.cmd_getMenu(void 0);return await this.mgrEtc.path_rename(e,t,n),this.mgrMenu.rebuildMenu()}async cmd_path_delete(e){const t=await this.cmd_getMenu(void 0);return await this.mgrEtc.path_delete(e,t),this.mgrMenu.rebuildMenu()}async cmd_path_merge(e,t){const n=await this.cmd_getMenu(void 0);return await this.mgrEtc.path_merge(e,t,n),this.mgrMenu.rebuildMenu()}async cmd_journal(){const e=new Date,t=`journal/${(n=e).getFullYear()}${o=n.getMonth()+1,`00${o}`.slice(-2)}.md`;var n,o;const s=await this.contentEx.get(t),a=await this.mgrEtc.journal(s,e);return await this.contentEx.set(t,a.content),a}}class le{constructor(e){this.KEY="",console.log(e),this.KEY=e}get(e){var t;if(null!=localStorage.getItem(this.KEY)){const n=JSON.parse(null!=(t=localStorage.getItem(this.KEY))?t:"");e(n),console.log(n)}}set(e){localStorage.setItem(this.KEY,JSON.stringify(e)),console.log(e)}}const ie=Symbol(),ce=()=>{const e=l(),t=i(),n=c({storeEx:new ae,persisted:new le("lifeLog-Viewer-params"),filename:"",obj:new G,code:"",isViewer:!1,dictMenu:[],tags:[],ObjTag:[],jump:-1,height:500}),o=e=>{console.log(`[update_filename] : new=${e}`),e!=n.filename&&(n.filename=e,s(e))},s=o=>{const s=o=>{-1==t.path.indexOf(o)&&(console.log(`_value=${o}`),e.push(`/${o}`)),n.persisted.set({filename:o})};if(console.log(`[load_obj] : new=${o}`),""==o)return r(""),void s(o);n.storeEx.cmd_load(o).then((e=>{const t=Object.assign(new G,e);a(t),s(o)})).catch((e=>{console.log("error")}))},a=e=>{e.update_tag(),r(e.content),n.tags=e.tags},r=e=>{n.code=e},d=e=>{n.dictMenu=e},u=e=>{const t=e.split("/"),n=t[t.length-1];return[t.slice(0,-1).join("/"),n]};return{store_data:{state:n,query_menu:(e="")=>{console.log(`[getMenu] filter=${e}`),n.storeEx.cmd_getMenu(e).then((e=>{console.log("update dictMenu"),d(e)})).catch((e=>{console.log("error:{error}")}))},update_height:e=>{n.height=e},update_jump:e=>{n.jump=e,n.ObjTag=JSON.parse(JSON.stringify(n.tags[e]))},save_code:async e=>{""!=e&&a(await n.storeEx.cmd_save(n.filename,e))},do_cmd:async(t,s,l)=>{const i=async(e,t)=>{if(t==await n.storeEx.cmd_exist(e))return!0;{const n=t?`error : ${e} is not exist. please enter exist filename.`:`error : ${e} is already exist. please enter other filename.`;return console.log(n),!1}};console.log(`[do_cmd] mode=${t},value=${s},value2=${l}`);let c=""!=s?s:n.filename,r="";switch(t){case"backup":n.storeEx.cmd_backup();break;case"export":n.storeEx.cmd_backupEx();break;case"restore":d(await n.storeEx.cmd_restore(0,null));break;case"import":d(await n.storeEx.cmd_restore(1,s));break;case"rebuild_menu":d(await n.storeEx.cmd_rebuild());break;case"filter_menu":d(await n.storeEx.cmd_getMenu(s));break;case"open_file":o(s);break;case"restore_file":console.log("restore_filename"),n.persisted.get((e=>{}));break;case"delete":await i(c,!0)&&(d(await n.storeEx.cmd_delete(c)),o(""));break;case"rename":await i(s,!1)&&(d(await n.storeEx.cmd_rename(l,s)),o(s));break;case"new":await i(s,!1)&&(d(await n.storeEx.cmd_create(s)),o(s));break;case"path_rename":const t=u(l)[0],m=u(s)[0];d(await n.storeEx.cmd_path_rename(t,m)),o("");break;case"path_delete":r=u(s)[0],await n.storeEx.cmd_path_delete(r),d(await n.storeEx.cmd_rebuild()),o("");break;case"split":await i(c,!0)&&d(await n.storeEx.cmd_split(c));break;case"path_merge":r=u(s)[0],c=`${r}.md`,await i(c,!1)&&(await n.storeEx.cmd_path_merge(r,c),d(await n.storeEx.cmd_rebuild()),o(c));break;case"print":const p=e.resolve({path:`/print/${n.filename}`});window.open(p.href,"_blank");break;case"journal":const h=await n.storeEx.cmd_journal();a(h),d(await n.storeEx.cmd_rebuild())}}}}},re=()=>s(ie),de=Symbol(),ue=()=>{a(de,(()=>{const e=c({objParam:null});return{store_dlg:{state:e,update_param:t=>{e.objParam=t}}}})())},me=()=>s(de);var pe=r({components:{},setup:()=>(a(ie,ce()),ue(),{})});pe.render=function(e,t,n,o,s,a){const l=d("routerView");return m(),u(l)};var he=r({emits:["event_callback"],props:{item:{type:Object,default:{}}},setup(e,t){const n=c({isOpen:!1,item:e.item,isFolder:e.item.children&&e.item.children.length});const o=(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)};return{state:n,onClick:function(e){if(n.isFolder)console.log("onClick-folder"),n.isOpen=!n.isOpen;else{const t=e.cmd;o(t,null)}},event_callback:o}}});p("data-v-743e6465");const ge={key:0,class:"item"},_e={key:1,class:"folder"},ve={key:2,class:"dropdown"};h(),he.render=function(e,t,n,o,s,a){const l=d("fa"),i=d("MenuTreeItem",!0);return m(),g("div",{class:"menu_tree",onClick:t[0]||(t[0]=t=>e.onClick(e.state.item)),onContextmenu:t[1]||(t[1]=y((()=>{}),["right","prevent"]))},[e.state.isFolder?f("",!0):(m(),g("span",ge,[_(l,{icon:e.item.icon},null,8,["icon"]),v(" "+b(e.state.item.title),1)])),e.state.isFolder?(m(),g("span",_e," ["+b(e.state.item.title)+"] ",1)):f("",!0),e.state.isFolder?(m(),g("div",ve,[(m(!0),g(k,null,w(e.state.item.children,((t,n)=>(m(),g("div",{key:n},[_(i,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))])):f("",!0)],32)},he.__scopeId="data-v-743e6465";var be=r({emits:["event_callback"],components:{MenuTreeItem:he},props:{mouse:{type:PointerEvent,default:{}},items:{type:Array,default:[]}},setup(e,t){const n=c({items:e.items,pos_x:-1,pos_y:-1,isShow:!1,style:"display:none"});x((()=>e.mouse),((t,o)=>{console.log("props"),n.isShow=!0,n.pos_x=e.mouse.clientX,n.pos_y=e.mouse.clientY,n.items=e.items,n.style="display:block"}));return{state:n,event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)},mouse_hover:function(e){n.style=e?"display:block":"display:none"}}}});be.render=function(e,t,n,o,s,a){const l=d("MenuTreeItem");return m(),g("div",{class:"menu",style:E(e.state.style),onMouseover:t[0]||(t[0]=t=>e.mouse_hover(!0)),onMouseleave:t[1]||(t[1]=t=>e.mouse_hover(!1))},[(m(!0),g(k,null,w(e.state.items,(t=>(m(),g("div",{key:t.path},[_(l,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))],36)},be.__scopeId="data-v-65ccdc9a";var fe=r({emits:["event_callback"],components:{MenuTree:be},props:{objMenu:{type:Array,default:[]}},setup(e,t){console.log("setup");const n=c({items:e.objMenu,event:void 0});return{state:n,onClick:function(e){console.log("onClick"),n.event=e},event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)}}}});fe.render=function(e,t,n,o,s,a){const l=d("fa"),i=d("MenuTree");return m(),g("div",{class:"dropdown",onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},[_(l,{icon:"bars"}),_(i,{mouse:e.state.event,items:e.state.items,onEvent_callback:e.event_callback},null,8,["mouse","items","onEvent_callback"])])},fe.__scopeId="data-v-f145f120";var ke=r({emits:["event_callback"],props:{objMenuItem:{type:Array,default:[]}},setup(e,t){console.log("setup");const n=c({items:[],isShowDlg:!1});return x((()=>e.objMenuItem),((e,t)=>{n.items=function(e){function t(e,t){const n=e.atime,o=t.atime;let s=0;return n>o?s=-1:n<o&&(s=1),s}console.log("[cnvLstRecent]");const n=[...e];return n.sort(t),n.slice(0,10)}(e)})),{state:n,mouse_hover:function(e){n.isShowDlg=e},select_file:function(e){const o=n.items[e].path;t.emit("event_callback","open_file",o),n.isShowDlg=!1}}}});p("data-v-28a02bc9");const we={key:0,class:"dropdown"},ye=["onClick"],xe={class:"title"},Ee={class:"title_sub"},$e={class:"title_sub"};h(),ke.render=function(e,t,n,o,s,a){const l=d("fa");return m(),g("div",{class:"menu",onMouseover:t[0]||(t[0]=t=>e.mouse_hover(!0)),onMouseleave:t[1]||(t[1]=t=>e.mouse_hover(!1))},[$("span",null,[_(l,{icon:"history"})]),e.state.isShowDlg?(m(),g("ul",we,[(m(!0),g(k,null,w(e.state.items,((t,n)=>(m(),g("li",{class:"item",key:n,onClick:t=>e.select_file(n)},[_(l,{class:"title_item",icon:"file-alt"}),$("span",xe,b(t.title),1),$("span",Ee," ("+b(t.group)+")",1),$("span",$e," ["+b(t.atime)+"]",1)],8,ye)))),128))])):f("",!0)],32)},ke.__scopeId="data-v-28a02bc9";var Ce=r({emits:["event_callback"],setup(e,t){console.log("setup");const n=c({filter:""}),o=e=>{console.log("[doFilter]"),t.emit("event_callback","filter_menu",n.filter)};return{state:n,doFilter:o,doClear:e=>{console.log("[doClear]"),n.filter="",o()}}}});p("data-v-aeef5b94");const Me={"no-gutters":""};h(),Ce.render=function(e,t,n,o,s,a){const l=d("fa");return m(),g("div",Me,[C($("input",{type:"text",class:"filter",placeholder:"filter","onUpdate:modelValue":t[0]||(t[0]=t=>e.state.filter=t),clearable:"",onBlur:t[1]||(t[1]=(...t)=>e.doFilter&&e.doFilter(...t)),onKeyup:t[2]||(t[2]=S(((...t)=>e.doFilter&&e.doFilter(...t)),["enter"]))},null,544),[[M,e.state.filter]]),$("span",{class:"cancel",onClick:t[3]||(t[3]=(...t)=>e.doClear&&e.doClear(...t))},[_(l,{icon:"times"})])])},Ce.__scopeId="data-v-aeef5b94";const Se=[{title:"split",cmd:"split",icon:"file",children:[]},{title:"path_merge",cmd:"dlg_path_merge",icon:"file",children:[]},{title:"journal",cmd:"journal",icon:"file",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"new",cmd:"dlg_new",icon:"file",children:[]},{title:"rename",cmd:"dlg_rename",icon:"pen",children:[]},{title:"bacup/restore",icon:"",cmd:"",children:[{title:"backup",cmd:"backup",icon:"cloud-upload-alt",children:[]},{title:"restore",cmd:"restore",icon:"cloud-download-alt",children:[]}]},{title:"export/import",icon:"",cmd:"",children:[{title:"export",cmd:"export",icon:"file-export",children:[]},{title:"import",cmd:"dlg_import",icon:"file-import",children:[]}]},{title:"",cmd:"",icon:"minus",children:[]},{title:"path_rename",cmd:"dlg_path_rename",icon:"sync",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"delete",cmd:"dlg_delete",icon:"trash-alt",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"path_delete",cmd:"dlg_path_delete",icon:"sync",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"config",cmd:"config",icon:"paw",children:[]},{title:"print",cmd:"print",icon:"print",children:[]}],je=[{title:"new",cmd:"dlg_new",icon:"file",children:[]},{title:"journal",cmd:"journal",icon:"file",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"rename",cmd:"dlg_rename",icon:"pen",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"delete",cmd:"dlg_delete",icon:"trash-alt",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"split",cmd:"split",icon:"file",children:[]}],Oe=[{title:"path_rename",cmd:"dlg_path_rename",icon:"sync",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"path_delete",cmd:"dlg_path_delete",icon:"sync",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"path_merge",cmd:"dlg_path_merge",icon:"file",children:[]}],Le={dlg_import:{commit:"import",title:"Restore",isFileOpen:!0},dlg_delete:{commit:"delete",title:"Delete",isInput:!0,isReadOnly:!0},dlg_rename:{commit:"rename",title:"Rename",isInput:!0},dlg_new:{commit:"new",title:"Create",isInput:!0},dlg_path_rename:{commit:"path_rename",title:"Rename of Path",isInput:!0,isPath:!0},dlg_path_delete:{commit:"path_delete",title:"Delete of Path",isInput:!0,isReadOnly:!0,isPath:!0},dlg_path_merge:{commit:"path_merge",title:"Merge of Path",isInput:!0,isReadOnly:!0,isPath:!0}};var Te=r({emits:["event_callback"],setup(e,t){console.log("setup");const n=c({timer:null,totalTime:1,displayed:0,tbl_timer:[1500,1500,300,900],btn_enable:0,state_status:-1,state:{times:1,color_bk:"blue",status_before:-1},timer3:-1}),o=j((()=>{const e=Math.floor(n.totalTime/60);return t=e,Number((t<10?"0":"")+t);var t})),s=j((()=>0));return j((()=>`${o}:${s}`)),j((()=>n.totalTime/n.displayed*100)),x((()=>n.state_status),((e,t)=>{})),O((()=>{console.log("[mounted]")})),{state:n}}});const Ie=["color"],De=T('<div id="popup" class="popup"> Pomodoro Timer <div id="base" class="panel circle"><div id="do_add" class="material-icons button">update</div><div id="do_next" class="material-icons button">skip_next</div><div id="do_focus" class="material-icons button">play_arrow</div><div id="do_stop" class="material-icons button">stop</div><div id="time"></div></div></div> @@@@ ',2),Ne={style:{font:"20px sans-serif",color:"white","text-shadow":"2px 2px 5px black","z-index":"5"},class:"pa-0 ma-0"},Ae=v("mdi-play"),Fe=v(" mdi-pause"),Re=v(" mdi-stop"),Pe=v(" mdi-skip-next");Te.render=function(e,t,n,o,s,a){const l=d("v-icon"),i=d("v-progress-circular");return m(),g("div",{color:e.state.color_bk},[De,_(i,{"_v-model":"totalTime",rotate:"-90",size:"40",value:e.progress,width:"5",color:"yellow",style:{width:"70px"}},{default:L((()=>[$("div",Ne,b(e.display),1),0!=(1&e.btn_enable)?(m(),u(l,{key:0,small:"",class:"play ma-0 pa-0",onClick:t[0]||(t[0]=t=>e.doAction("goto_focus",1)),style:{position:"absolute",top:"0px",right:"0px","z-index":"5"}},{default:L((()=>[Ae])),_:1})):f("",!0),0!=(2&e.btn_enable)?(m(),u(l,{key:1,small:"",class:"pause ma-0 pa-0",onClick:t[1]||(t[1]=t=>e.doAction("pause",1)),style:{position:"absolute",bottom:"0px",right:"0px","z-index":"5"}},{default:L((()=>[Fe])),_:1})):f("",!0),0!=(4&e.btn_enable)?(m(),u(l,{key:2,small:"",class:"reset ma-0 pa-0",onClick:t[2]||(t[2]=t=>e.doAction("reset",1)),style:{position:"absolute",top:"0px",left:"0px","z-index":"5"}},{default:L((()=>[Re])),_:1})):f("",!0),0!=(8&e.btn_enable)?(m(),u(l,{key:3,small:"",class:"next ma-0 pa-0",onClick:t[3]||(t[3]=t=>e.doAction("next",1)),style:{position:"absolute",bottom:"0px",left:"0px","z-index":"5"}},{default:L((()=>[Pe])),_:1})):f("",!0)])),_:1},8,["value"])],8,Ie)};var Be=r({emits:["event_callback"],components:{MenuCmd:fe,MenuRecent:ke,MenuFile:Ce,PomodoroPuchi:Te},setup(e,t){console.log("setup");const{store_data:n}=re();me();const o=I(null),s=c({filename:n.filename,objMenu:Se,dctMenu:[]});O((()=>{console.log("[mounted]")}));x((()=>n.state.filename),((e,t)=>{console.log(`[watch:filename] ${e}`),a(e)})),x((()=>n.state.dictMenu),((e,t)=>{s.dctMenu=e}));const a=e=>{console.log(`[onChanged_filename] new=${e}`);s.filename=((e,t)=>{const n=e.filter((function(e){return e.path==t}));return n.length>0?`${n[0].group}/${n[0].title}`:"no title"})(n.state.dictMenu,e);o.value.scrollIntoView({})};return{state:s,doAction:e=>{console.log(`[doAction] cmd=${e}`),t.emit("event_callback",e,!0)},event_callback:(e,n)=>{if(console.log(`[event_callback] cmd=${e}`),"top"==e){o.value.scrollIntoView({})}else t.emit("event_callback",e,n)},appbar:o}}});p("data-v-10a2a704");const He={class:"nav"},Ve=$("section",{class:"item logo"},"Oden",-1),Je={class:"cmd"};h(),Be.render=function(e,t,n,o,s,a){const l=d("MenuCmd"),i=d("fa"),c=d("MenuRecent"),r=d("MenuFile");return m(),g("header",{class:"appbar",ref:"appbar",onClick:t[2]||(t[2]=t=>e.event_callback("top",!0))},[$("nav",He,[_(l,{class:"item",objMenu:e.state.objMenu,onEvent_callback:e.event_callback},null,8,["objMenu","onEvent_callback"]),Ve,""!==e.state.filename?(m(),g("span",{key:0,class:"item name",onClick:t[0]||(t[0]=t=>e.event_callback("dlg_rename",null))}," ["+b(e.state.filename)+"] ",1)):f("",!0),$("span",{class:"item",onClick:t[1]||(t[1]=t=>e.doAction("toggle_editor"))},[_(i,{icon:"edit"})])]),$("div",Je,[_(c,{class:"item",objMenuItem:e.state.dctMenu,onEvent_callback:e.event_callback},null,8,["objMenuItem","onEvent_callback"]),_(r,{class:"item",onEvent_callback:e.event_callback},null,8,["onEvent_callback"])])],512)},Be.__scopeId="data-v-10a2a704";var Ue=r({emits:["event_callback"],components:{MenuTree:be},props:{item:{type:Object,default:{}}},setup(e,t){const{store_data:n}=re(),o=c({isOpen:!1,item:e.item,isFolder:e.item.children&&e.item.children.length,menu:[],event:null});return{state:o,onClick:function(e){if(o.isFolder)console.log("onClick-folder"),o.isOpen=!o.isOpen;else{const t=e.path;console.log(`onClick-filename=${t}`),n.do_cmd("open_file",t)}},onClickEx:function(e){console.log("onClickEx"),o.menu=o.isFolder?Oe:je,o.event=e},event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)},event_callbackEx:(e,n)=>{console.log(`[event_callbackEx] cmd=${e}`);const s=o.item.path;t.emit("event_callback",e,s)}}}});p("data-v-0b8c287b");const Ke={class:"file_tree"},ze={key:0,class:"item"},qe={key:1,class:"folder"},Ye={key:0,"_v-if":"state.isFolder"};h(),Ue.render=function(e,t,n,o,s,a){const l=d("MenuTree"),i=d("fa"),c=d("tree-item",!0);return m(),g("li",Ke,[_(l,{mouse:e.state.event,items:e.state.menu,onEvent_callback:e.event_callbackEx},null,8,["mouse","items","onEvent_callback"]),$("div",{onContextmenu:t[0]||(t[0]=y(((...t)=>e.onClickEx&&e.onClickEx(...t)),["prevent"])),onClick:t[1]||(t[1]=t=>e.onClick(e.state.item))},[e.state.isFolder?f("",!0):(m(),g("span",ze,b(e.state.item.name),1)),e.state.isFolder?(m(),g("span",qe,[_(i,{icon:e.state.isOpen?"folder-open":"folder"},null,8,["icon"]),v(" ["+b(e.state.item.name)+"] ",1)])):f("",!0)],32),e.state.isOpen?(m(),g("div",Ye,[(m(!0),g(k,null,w(e.state.item.children,((t,n)=>(m(),g("div",{key:n},[_(c,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))])):f("",!0)])},Ue.__scopeId="data-v-0b8c287b";var We=r({emits:["event_callback"],components:{TreeItem:Ue},setup(e,t){console.log("setup");const{store_data:n}=re(),o=c({items:void 0});x((()=>n.state.dictMenu),((e,t)=>{!function(e){console.log("[onChanged_dictMenu]"),o.items=void 0;const t={name:"",children:[],path:"",file:""},n="/",s={[n]:t};e.forEach((function(e){e.key.split("/").reduce((function(t,o){if(t[o])return t[o];{const s={name:o,children:[],path:e.path,file:"md"};return t[n].children.push(s),t[n].file="",t[o]={[n]:s}}}),s)})),console.log(t),setTimeout((()=>{o.items=t.children}),500)}(e)}));return{state:o,event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)}}}});p("data-v-00d579e2");const Ge={class:"tree"};h(),We.render=function(e,t,n,o,s,a){const l=d("tree-item");return m(),g("div",Ge,[(m(!0),g(k,null,w(e.state.items,(t=>(m(),g("div",{key:t.path},[_(l,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))])},We.__scopeId="data-v-00d579e2";var Qe=r({props:{level:{type:Number,required:!0}},setup(e,t){console.log("setup");return{tag:j((()=>`h${e.level}`))}}});Qe.render=function(e,t,n,o,s,a){return m(),u(D(e.tag),{class:"h_tag"},{default:L((()=>[N(e.$slots,"default",{},void 0,!0)])),_:3})},Qe.__scopeId="data-v-90dffff2";var Xe=r({emits:["event_callback"],components:{heading:Qe},setup(e,t){console.log("setup");const{store_data:n}=re(),o=c({listTag:[]});return x((()=>n.state.tags),((e,t)=>{console.log(e),o.listTag=e})),{state:o,dispTitle:function(e){return`${e.text}`},jumpSource:function(e){console.log("[jumpSource] index="+e),n.update_jump(e)}}}});p("data-v-658c4f7a");const Ze={class:"tag"},et=["onClick"];h(),Xe.render=function(e,t,n,o,s,a){const l=d("heading");return m(),g("div",Ze,[(m(!0),g(k,null,w(e.state.listTag,((t,n)=>(m(),g("div",{key:n,onClick:t=>e.jumpSource(n),class:"item"},[_(l,{level:t.tag},{default:L((()=>[v(b(e.dispTitle(t)),1)])),_:2},1032,["level"])],8,et)))),128))])},Xe.__scopeId="data-v-658c4f7a";var tt=r({emits:["event_callback"],setup(e,t){console.log("setup");return{objToolbar:[{icon:"bold",cmd:"Bold"},{icon:"italic",cmd:"Italic"},{icon:"underline",cmd:"Underline"},{icon:"strikethrough",cmd:"Strikethrough"},{icon:"code",cmd:"Code"},{icon:"check-square",cmd:"Check"},{icon:"table",cmd:"Table"},{icon:"link",cmd:"Link"},{icon:"chevron-right",cmd:"Blockquotes"},{icon:"paint-roller",cmd:"ColorText"},{icon:"calendar",cmd:"Today"},{icon:"expand",cmd:"Expand"},{icon:"bolt",cmd:"Format"}],event_callback:(e,n)=>{console.log(`cmd=${e}, name=${n}`),t.emit("event_callback",e,n)}}}});p("data-v-6cc11e75");const nt={class:"main",style:{_height:"100px"}},ot=["onClick"];h(),tt.render=function(e,t,n,o,s,a){const l=d("fa");return m(),g("div",nt,[(m(!0),g(k,null,w(e.objToolbar,((t,n)=>(m(),g("button",{class:"btn-item",key:n,onClick:n=>e.event_callback("action",t.cmd)},[_(l,{icon:t.icon},null,8,["icon"])],8,ot)))),128))])},tt.__scopeId="data-v-6cc11e75";const st={};class at{constructor(e,n){t(this,"cmdid",0),t(this,"monaco",null),t(this,"editor",null),console.log("[constructer]"),this.monaco=e,this.editor=n}add(e,t,n,o,s=null){let a;switch(o.length){case 0:a=this.generateCommand(e,s);break;case 1:a=this.generateHeaderCommand(o[0]);break;case 2:a=this.generateWrapperCommand(o[0],o[1])}st[e]=a,this.editor.addAction({id:"markdown-"+this.cmdid++,label:e,keybindings:n,contextMenuGroupId:t&&"navigation",contextMenuOrder:t&&1.5,run:st[e]})}generateCommand(e,t){return(e,n)=>{t(e)}}generateWrapperCommand(e,t){const n=e.length+t.length;return this.editor,this.editor.getModel(),this.monaco,console.log(`startText=${e}, endText=${t}`),(o,s)=>{const a=o.getModel(),l=o.getSelections();if(null==l)return;const i=[];return l.forEach((o=>{i.push(new s.Selection(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn+n)),a.pushEditOperations([],[{range:{startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.startLineNumber,endColumn:o.startColumn},text:e},{range:{startLineNumber:o.endLineNumber,startColumn:o.endColumn,endLineNumber:o.endLineNumber,endColumn:o.endColumn},text:t}])})),o.setSelections(i),null}}generateHeaderCommand(e){return this.editor,this.editor.getModel(),(t,n)=>{const o=t.getModel();let s=t.getSelections();return null==s&&(s=[t.getSelection()]),s.forEach((t=>{const n=o.findNextMatch("^(#+ )",{lineNumber:t.startLineNumber,column:1},!0,!1,null,!0);if(null!=n&&n.range.startLineNumber==t.startLineNumber&&1==n.range.startColumn){if(n.matches[1]==e)return;o.pushEditOperations([],[{range:{startLineNumber:t.startLineNumber,startColumn:1,endLineNumber:t.startLineNumber,endColumn:n.matches[1].length+1},text:""}])}o.pushEditOperations([],[{range:{startLineNumber:t.startLineNumber,startColumn:1,endLineNumber:t.startLineNumber,endColumn:1},text:e}])})),null}}}const lt={autoIndent:!0,lineNumbersMinChars:4,minimap:{enabled:!0},wordWrap:"on",renderWhitespace:"all",selectOnLineNumbers:!0,automaticLayout:!0,fontSize:16,scrollBeyondLastLine:!1,formatOnType:!0,language:"markdown",theme:"vs"};var it=r({emits:["event_callback"],components:{ToolbarEditor:tt},props:{isActive_preview:{type:Boolean,default:!1}},setup(e,t){console.log("setup");const n=I(null),o={editor:void 0},{store_data:s}=re(),a=c({iVersion:-1,scrollInfo:{height:0,top:0},isScrolled:!1});O((()=>{console.log("[mounted]"),i()})),x((()=>s.state.code),((e,t)=>{console.log("[watch-body]"),m(e),d(0),a.isScrolled=!1})),x((()=>s.state.ObjTag),((e,t)=>{console.log(`[watch](ObjTag)-${e}`),l(e)})),x((()=>e.isActive_preview),((e,t)=>{console.log(`[watch](editor_toggle)-${e}`),1==e&&p(),a.isScrolled=!1}));const l=e=>{console.log(`[jump_cursor]ObjTag={${Object.values(e)}}`);const t=e.line;d(t),setTimeout((()=>{a.isScrolled=!1}),1e3)},i=()=>{o.editor=(()=>{const e=document.getElementById("container");if(console.log(`root=${e}`),null==e)return;const t=A.create(e,lt);return function(e,t){console.log("[setupShortcutKeys]");const n=new at(e,t);n.add("Bold","8_",[],["**","**"]),n.add("Italic","1_",[],["__","__"]),n.add("Underline","9_",[],["<u>","</u>"]),n.add("Strikethrough",!1,[e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KEY_S],["~~","~~"]),n.add("Code",!1,[],["`","`"]),n.add("Link",!1,[],["[","]()"]),n.add("Link-2",!1,[],["[](",")"]),n.add("ColorText",!1,[],['<span style="color: red; ">',"</span>"]),n.add("Expand",!1,[],["<details><summary>",["</summary>","</details>"].join("\n")]),n.add("Header 1",!1,[],["# ",""]),n.add("Header 2",!1,[],["## ",""]),n.add("Header 3",!1,[],["### ",""]),n.add("Header 4",!1,[],["#### ",""]),n.add("Header 5",!1,[],["##### ",""]),n.add("Header 6",!1,[],["###### ",""]),n.add("Check",!1,[],["- [ ] ",""]),n.add("Blockquotes",!1,[],["> ",""]),n.add("Today",!1,[],[`${(new Date).toLocaleString()}`,""]),n.add("Table",!1,[],[["| Column | Column | Column |","| ------ | ------ | ------ |","| Text   | Text   | Text   |",""].join("\n"),""]),n.add("Format","8_",[],[],(e=>{console.log("format"),e.getAction("editor.action.formatDocument").run()}))}(F,t),console.log(`editor=${t}`),t.onDidScrollChange((e=>{a.scrollInfo.height=e.scrollHeight,a.scrollInfo.top=e.scrollTop,a.isScrolled=!0})),t})()},r=e=>{console.log("[action]"),null!=st[e]&&st[e](o.editor,F)},d=e=>{const t=new R(e+1,0,e+1,0);console.log(`Line=${e}`),o.editor.revealRangeAtTop(t)},u=()=>o.editor.getModel().getAlternativeVersionId(),m=e=>{console.log("[watch-body]"),o.editor.setValue(e),a.iVersion=u()},p=()=>{console.info("[save_content]");const e=u();if(console.info(`iVersion=${a.iVersion}, iVersion_cur=${e}`),a.iVersion==e)return;const t=o.editor.getValue();s.save_code(t),a.iVersion=u(),console.info(`iVersion=${a.iVersion}`)},h=j((()=>s.state.height-27+"px"));return{editorEx:o,event_callback:(e,t)=>{switch(console.log(`[event_callback] cmd=${e}`),e){case"action":r(t);break;case"save":p()}},HeightEx:h,md_editor_monaco:n,get_position:()=>{o.editor;const e=o.editor.getScrollTop(),t=o.editor.getScrollHeight();return console.log(`scrollTop=${e}, scrollHeight=${t}`),{top:e,height:t,scrolled:a.isScrolled}},set_position:e=>{console.log(`[e-set]value=${JSON.stringify(e)}`);const t=e.top/e.height;console.log(`per=${t}`);const n=o.editor.getScrollHeight();o.editor.setScrollTop(n*t)}}}});p("data-v-c517a7a6");const ct={class:"editor"};h(),it.render=function(e,t,n,o,s,a){const l=d("ToolbarEditor");return m(),g("div",ct,[_(l,{class:"toolbar",onEvent_callback:e.event_callback},null,8,["onEvent_callback"]),$("div",{id:"container",ref:"md_editor_monaco",class:"core",style:E({height:e.HeightEx})},null,4)])},it.__scopeId="data-v-c517a7a6";var rt=r({components:{},props:{isActive_preview:{type:Boolean,default:!1}},setup(e,t){console.log("setup");const n=I(null),{store_data:o}=re(),s=c({isScrolled:!1});O((()=>{console.log("[created]"),function(){const e=new P.Renderer;e.link=function(e,t,n){return-1!=e.indexOf("http")?`<a target="_blank" href="${e}">${n}</a>`:`<a target="_blank" href="#${e}">${n}</a>`},P.setOptions({renderer:e,langPrefix:"",breaks:!0})}(),n.value.onscroll=e=>{s.isScrolled=!0}})),x((()=>o.state.code),((e,t)=>{console.log("[watch-body]");n.value.scrollTop=0,s.isScrolled=!1})),x((()=>o.state.ObjTag),((e,t)=>{console.log(`[watch](ObjTag)-${e}`),function(e){const t=(e,t)=>{console.log(`tag=${e}, num=${t}`);const o=n.value.querySelectorAll(".md_core_viewer > h"+e);o.length>t&&o[t].scrollIntoView({behavior:"smooth",block:"start",inline:"start"})},o=()=>{setTimeout((()=>{s.isScrolled=!1}),1e3)};console.log(`[jump_cursor]ObjTag={${Object.values(e)}}`);const a=e.tag,l=e.num;e.line,t(a,l),o()}(e)})),x((()=>e.isActive_preview),((e,t)=>{console.log(`[watch](editor_toggle)-${e}`),s.isScrolled=!1}));const a=j((()=>P(o.state.code))),l=j((()=>o.state.height+"px"));return{status:status,Markdown:a,HeightEx:l,md_viewer:n,get_position:()=>{const e=n.value;return{top:e.scrollTop,height:e.scrollHeight,scrolled:s.isScrolled}},set_position:e=>{console.log(`[v-set]value=${JSON.stringify(e)}`);const t=e.top/e.height;console.log(`per=${t}`);const o=n.value;console.log(`scrollTop=${o.scrollTop}, scrollHeight=${o.scrollHeight}`),o.scrollTop=o.scrollHeight*t}}}});p("data-v-20ff32b7");const dt=["innerHTML"];h(),rt.render=function(e,t,n,o,s,a){return m(),g("div",{class:"md_core_viewer",innerHTML:e.Markdown,style:E({height:e.HeightEx}),ref:"md_viewer"},null,12,dt)},rt.__scopeId="data-v-20ff32b7";var ut=r({components:{MarkdownEditor:it,MarkdownViewer:rt},props:{editor_toggle:{type:Boolean,default:!0}},setup(e,t){console.log("setup");const n=I(),o=I(),s=c({isActive_preview:!0,timer3:-1});x((()=>e.editor_toggle),((e,t)=>{console.log(`[watch](editor_toggle)-${e}`),l()})),O((()=>{console.log("[mounted]"),document.addEventListener("keydown",a)})),B((()=>{document.removeEventListener("keydown",a)}));const a=e=>83===e.keyCode&&e.ctrlKey?(e.preventDefault(),console.log("save"),void l()):69===e.keyCode&&e.ctrlKey?(e.preventDefault(),console.log("toggle"),void l()):void 0,l=()=>{var e,t;const a=()=>s.isActive_preview=!l;let l=s.isActive_preview;if(console.log(`(before)isActive_preview=${l}`),l){const t=null==(e=n.value)?void 0:e.get_position();console.log(`[v]scrollIndo=${JSON.stringify(t)}`),a(),setTimeout((()=>{var e;t.scrolled&&(null==(e=o.value)||e.set_position(t))}),500)}else{const e=null==(t=o.value)?void 0:t.get_position();console.log(`[e]scrollIndo=${JSON.stringify(e)}`),a(),setTimeout((()=>{var t;e.scrolled&&(null==(t=n.value)||t.set_position(e))}),500)}};return{state:s,MdViewer:n,MdEditor:o}}});ut.render=function(e,t,n,o,s,a){const l=d("MarkdownEditor"),i=d("MarkdownViewer");return m(),g("div",null,[_(l,{class:"md_editor",ref:"MdEditor",style:E({display:e.state.isActive_preview?"none":""}),isActive_preview:e.state.isActive_preview},null,8,["style","isActive_preview"]),_(i,{class:"md_viewer",ref:"MdViewer",style:E({display:e.state.isActive_preview?"":"none"}),isActive_preview:e.state.isActive_preview},null,8,["style","isActive_preview"])])};var mt=r({emits:["event_callback"],setup(e,t){console.log("setup");const{store_dlg:n}=me(),{store_data:o}=re(),s=c({cmd:"",filename:"",filename_org:"",commit:"",title:"",isFileOpen:!1,isInput:!1,isReadOnly:!1,isShowDlg:!1,isDisabled:!0,isPath:!1});x((()=>n.state.objParam),(e=>{a(e)}));const a=e=>{console.log("[onChanged_objParam]"),s.cmd=e.cmd,s.filename=e.filename,s.filename_org=e.filename,s.commit=e.commit,s.title=e.title,s.isFileOpen=null!=e.isFileOpen&&e.isFileOpen,s.isInput=null!=e.isInput&&e.isInput,s.isReadOnly=null!=e.isReadOnly&&e.isReadOnly,s.isShowDlg=!0,s.isDisabled=!0,s.isPath=null!=e.isPath&&e.isPath,i(!0)},l=e=>{console.log(`[doAction] flg=${e}, filename=${s.filename}, commit=${s.commit}`),e&&o.do_cmd(s.commit,s.filename,s.filename_org),s.isShowDlg=!1,i(!1)},i=e=>{1==e?document.addEventListener("keydown",r):document.removeEventListener("keydown",r)},r=e=>{if(27===e.keyCode)return e.preventDefault(),void l(!1)};return{state:s,props:e,doAction:l,onFileChange:e=>{const t=(e.target.files||e.dataTransfer.files)[0];o.do_cmd(s.commit,t),s.isShowDlg=!1,i(!1)},isDisabled:()=>{const e=s.filename_org,t=s.filename==e&&!s.isReadOnly;return console.log(`[isDisabled]=${t}`),t}}}});p("data-v-762512ac");const pt={class:"modal-mask"},ht={class:"modal-wrapper"},gt={class:"modal-container"},_t={class:"header"},vt={ref:"form",_model:"state.isForm",class:"form"},bt=["pattern","disabled"],ft={class:"modal-actions"},kt=["disabled"];h(),mt.render=function(e,t,n,o,s,a){const l=d("fa");return C((m(),u(V,{persistent:""},{default:L((()=>[$("div",pt,[$("div",ht,[$("div",gt,[$("div",_t,[$("span",null,b(e.state.title)+"?",1)]),$("form",vt,[1==e.state.isFileOpen?(m(),g("input",{key:0,class:"input",type:"file",onChange:t[0]||(t[0]=(...t)=>e.onFileChange&&e.onFileChange(...t))},null,32)):f("",!0),1==e.state.isInput?C((m(),g("input",{key:1,class:"input",type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.state.filename=t),pattern:[()=>!!e.state.filename],required:"",autofocus:"",disabled:e.state.isReadOnly},null,8,bt)),[[M,e.state.filename]]):f("",!0)],512),$("div",ft,[$("button",{class:"btn btn-can",onClick:t[2]||(t[2]=t=>e.doAction(!1))},"cancel"),$("button",{class:"btn btn-ok",ref:"ok",disabled:e.isDisabled(),onClick:t[3]||(t[3]=t=>e.doAction(!0))},[_(l,{icon:"check"}),v(" "+b(e.state.title),1)],8,kt)])])])])])),_:1},512)),[[H,e.state.isShowDlg]])},mt.__scopeId="data-v-762512ac";var wt=r({components:{Appbar:Be,PreviewMd:ut,ListFile:We,ListTag:Xe,CmnDlg:mt},setup(e,t){console.log("setup");const{store_data:n}=re(),{store_dlg:o}=me(),s=l(),a=i(),r={snackbar:!1,message:"",timeout:-1,color:"green",actions:()=>{console.log("sb_actions")}},d=c({editor_toggle:!1,height:window.innerHeight-45,objDlgCmn:void 0,objDlgConf:void 0,snackbar_ex:r});O((()=>{console.log("[mounted]"),u(),window.addEventListener("resize",m),document.body.style.overflow="hidden"})),B((()=>{console.log("unmounted!"),window.removeEventListener("resize",m)}));const u=()=>{console.log("init"),console.log(`routepath=${a.path}`);const e=a.params.pathMatch;console.log(`filename=${e}`),console.log(`params=${JSON.stringify(a.params)}`),null==e||""==e?n.do_cmd("restore_file",""):n.do_cmd("open_file",""),n.query_menu(),m()},m=()=>{const e=window.innerHeight-45;console.log(`height=${e}`),n.update_height(e)};return{state:d,event_callback:async(e,t)=>{switch(console.log(`[event_callback] cmd=${e}, va0=${t}`),e){case"toggle_editor":d.editor_toggle=!d.editor_toggle;break;case"openSnackbar":case"onClick_snackbar":break;case"config":d.objDlgConf={cmd:e,filename:"",commit:""};break;case"print":const a=s.resolve({path:`/print/${n.filename}`});window.open(a.href,"_blank");break;default:if(-1!=e.indexOf("dlg_")){const s=Object.assign({},function(e,t){const o=Le[e],s=null!=t?t:n.state.filename;switch(e){case"dlg_import":o.filename="";break;case"dlg_new":o.filename=s.split("/").slice(0,-1).join("/")+"/*.md";break;default:-1!=e.indexOf("dlg_path_")?o.filename=s.split("/").slice(0,-1).join("/")+"/":o.filename=s}return o}(e,t));o.update_param(s)}else n.do_cmd(e,t)}}}}});p("data-v-5ba8430e");const yt={class:"container"},xt={class:"main"};h(),wt.render=function(e,t,n,o,s,a){const l=d("Appbar"),i=d("CmnDlg"),c=d("ListFile"),r=d("ListTag"),u=d("PreviewMd");return m(),g("div",yt,[_(l,{ref:"appbar",onEvent_callback:e.event_callback},null,8,["onEvent_callback"]),_(i,{objParam:e.state.objDlgCmn,onEvent_callback:e.event_callback},null,8,["objParam","onEvent_callback"]),$("div",xt,[_(c,{class:"col-3",onEvent_callback:e.event_callback,style:E({height:e.state.height+"px"})},null,8,["onEvent_callback","style"]),_(r,{class:"col-1",onEvent_callback:e.event_callback,style:E({height:e.state.height+"px"})},null,8,["onEvent_callback","style"]),_(u,{class:"col-2",ref:"pane",editor_toggle:e.state.editor_toggle,style:E({height:e.state.height+"px"})},null,8,["editor_toggle","style"])])])},wt.__scopeId="data-v-5ba8430e";var Et=r({components:{MarkdownViewer:rt},setup(e,t){console.log("setup");const{store_data:n}=re(),o=i(),s=c({filename:"",height:window.innerHeight,timer3:-1});O((()=>{console.log("[mounted]"),a(),document.body.style.overflow="hidden"}));const a=()=>{console.log("init");const e=o.params.pathMatch;console.log(`filename=${e}`),null==e||""==e?n.get_filename():n.update_filename(e),s.filename=e,s.timer3=window.setTimeout((()=>{clearTimeout(s.timer3),window.print()}),500)};return{state:s}}});const $t={_class:"container"};Et.render=function(e,t,n,o,s,a){const l=d("MarkdownViewer");return m(),g("div",$t,[v(b(e.state.filename)+" ",1),_(l,{class:"md_viewer",_ref:"MdViewer",style:{"{\n          height":"initial"}})])};const Ct=[{name:"viewer",path:"/:pathMatch(.*)",component:wt},{name:"viewer_print",path:"/print/:pathMatch(.*)",component:Et}],Mt=J({history:U(),routes:Ct});!function(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:s,onRegisterError:a}=e;let l;"serviceWorker"in navigator&&(l=new K("./sw.js",{scope:"./"}),l.addEventListener("activated",(e=>{e.isUpdate?window.location.reload():null==o||o()})),l.register({immediate:t}).then((e=>{null==s||s(e)})).catch((e=>{null==a||a(e)})))}(),z.add(q),Y(pe).use(Mt).component("fa",W).mount("#app");
