var e=Object.defineProperty,t=(t,n,o)=>(((t,n,o)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o})(t,"symbol"!=typeof n?n+"":n,o),o);import{i as n,r as o,g as i,b as s,D as a,a as l,c,d as r,u as d,e as u,f as m,G as h,s as g,o as p,h as _,p as b,j as v,k as f,l as k,m as w,n as y,q as E,t as x,v as $,w as C,x as M,y as S,z as O,A as j,F as L,B as T,C as D,E as A,H as N,I,J as R,K as F,L as B,M as V,N as P,O as H,P as U,Q as J,R as q,S as K,T as Y,U as G,V as z,W,X,Y as Z,Z as Q,_ as ee,$ as te,a0 as ne,a1 as oe,a2 as ie,a3 as se,a4 as ae}from"./vendor.26a3cb13.js";const le={apiKey:"AIzaSyBoSqHGiXXzJJwOVPJyNZ8GbzAvyxhLyyg",authDomain:"oden-ab654.firebaseapp.com",projectId:{}.VUE_VITE_FIREBASE_PROJECT_ID,storageBucket:"oden-ab654.appspot.com",messagingSenderId:"441612230982",appId:"1:441612230982:web:38bf7c96722193eb88c547",measurementId:{}.VITE_FIREBASE_APP_ID};console.log(le);const ce=n(le);o(ce);i(ce).setPersistence(s);class re{constructor(){this.id=-1,this.content="",this.path="",this.title="",this.group="",this.atime=Date(),this.ctime=Date(),this.tags=[],this.htags=[],this.position=void 0}set(e,t="",n=[],o=!1){""!=t&&(this.path=t),n!=[]&&(this.tags=n),this.content=e;const i=this.get_time();this.atime=i,1==o&&(this.ctime=i)}set_default(e){this.path=e,this.content="",this.tags=[];const t=this.get_time();this.atime=t,this.ctime=t}copy(e){Object.assign(this,e)}duplicate(e,t=""){const n=new re;return n.copy(this),n.content=e,n.path=t,n.update_contentEx(),n.update_time(),n}update_content(e){this.content=e,this.atime=this.get_time(),this.update_contentEx()}update_contentEx(){this.tags=this.build_tag(this.content)}update_position(e){this.position=e}get_time(){return this.cnv_time(new Date)}cnv_time(e){const t=e=>`00${e}`.slice(-2);return`${e.getFullYear()}/${t(e.getMonth()+1)}/${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`}update_time(){this.atime=this.cnv_time(new Date(this.atime)),this.ctime=this.cnv_time(new Date(this.ctime))}static rebuild_body(e){return e}update_tag(){this.tags=this.build_tag(this.content)}build_tag(e){console.log("[build_tag]");const t=[],n=[0,0,0,0,0],o=e.split(/\r\n|\n|\r/);for(let i=0;i<o.length;i++){if(-1!=o[i].search(/^\s*#/)){const e=o[i].split(" "),s=e[0].length;e.shift();const a=e.join(" ");t.push({text:a,line:i,tag:s,num:n[s]}),n[s]++}}return t}split(e){const t=[],n=this.content.split(/\r\n|\n|\r/),o=this.tags.filter((function(t){return t.tag==e})),i=[],s=n.length;for(var a=0;a<o.length;a++){const e=o[a].line;i.push({start:e,end:s,title:o[a].text}),0!=a&&(i[a-1].end=e-1)}const l=this.path.indexOf(".md")?this.path.slice(0,-3):this.path;return i.reverse(),i.forEach((e=>{const o=n.splice(e.start,e.end).join("\r\n"),i=this.duplicate(o,`${l}/${e.title}`);t.push(i)})),t.reverse(),t}}class de extends a{constructor(){super("OdenDB"),this.version(2).stores({viewer:"key, ctime"}),this.viewer=this.table("viewer")}}class ue{constructor(e){this.db=new de,this.ctime="",this.atime="",this.getStrageEx=async()=>await this.getAll(),this.read=async e=>{const t=await this.dbx.get(e);return null!=t?t.data:null},this.write=async(e,t)=>{const n=JSON.stringify(t);await this.dbx.put({key:e,data:n,ctime:this.set_time_DB()}),this.set_time_DB()},this.delete=async e=>{await this.dbx.delete(e),this.set_time_DB()},this.caller=e,this.dbx=this.db.viewer,this.getAll()}get_dbx(){return this.db.viewer}async getAll(){const e=[];return(await this.dbx.toArray()).forEach((t=>{e[t.key]=t.data})),this.atime=this.get_time_DB(),e}async sync_DB(){0==this.check_async_DB()&&await this.getAll()}check_async_DB(){return this.atime==this.get_time_DB()}set_time_DB(){const e=JSON.stringify(new Date);return localStorage.setItem("update_DB_time",e),this.atime=e,e}get_time_DB(){var e;return null!=(e=localStorage.getItem("update_DB_time"))?e:""}}class me{constructor(e){this.write=(e,t)=>this.storeLS.write(e,t),this.delete=e=>this.storeLS.delete(e),this.rename=async(e,t)=>{console.log(`[rename] _key_org=${e}, _key_new=${t}`);const n=this.as(await this.get(e));return n.path=t,await this.write(t,n),await this.delete(e),n},this.split=async e=>{console.log(`[split] _key_org=${e}`);const t=this.as(await this.get(e)).split(1);return t.forEach((e=>{this.write(e.path,e)})),t},this.merge=(e,t)=>{console.log(`[merge] _path=${e}`);const n=new re;return n.set_default(e),n.update_content(t),this.write(e,n),n},this.as=e=>Object.assign(new re,e),this.sync_DB=()=>this.storeLS.sync_DB(),this._=e,this.storeLS=new ue(this._)}async get(e){console.log(`[get] _key=${e}`);const t=await this.read(e);return null!=t?JSON.parse(t):this.create(e)}async exist(e){console.log(`[exist] _key=${e}`);return null!=await this.read(e)}async set(e,t){console.log(`[set] _key=${e}`);const n=this.as(await this.get(e));return""==n.path&&(n.path=e),n.update_content(t),this.write(e,n),n}async read(e){return await this.storeLS.read(e)}async update_position(e,t){console.log(`[update_position] _key=${e}`);const n=this.as(await this.get(e));return n.update_position(t),this.write(e,n),n}create(e){console.log(`[create] _key=${e}`);const t=new re;return null!=e&&(t.set_default(e),this.write(e,t)),t}}class he{constructor(e){this._=e}async rebuildMenu(e=null){console.log("[rebuildMenu]");const t=await this._.mgrCache.getLstContent(e),n=this.buildMenu(t);return console.log(`${t.length}/${n.length}`),this._.contentEx.set("menu.json",JSON.stringify(n)),n}async getMenu(e){if(console.log(`[getMenu] _filter=${JSON.stringify(e)}`),null!=e)return await this.rebuildMenu(e);{const e=await this._.contentEx.get("menu.json");return JSON.parse(e.content)}}buildMenu(e){return function(e){console.log("storeEx_index:buildMenuEx");const t=function(e){const t=new Set;return e.forEach((e=>{t.add(e.group)})),[...t]}(e);return e.reduce(((e,n)=>{if("menu.json"==n.path)return e;let o=n.group,i=n.title,s=`${o}/${i}`;return t.includes(s)&&(o=s,i=".index",s=`${o}/${i}`),e.push({key:s,group:o,title:i,path:n.path,atime:n.atime}),e}),[])}(e).sort(this.compare_group)}compare_group(e,t){let n=e.group,o=t.group;n==o&&(n=`${e.group}/${e.title}`,o=`${t.group}/${t.title}`);const i=n.toUpperCase(),s=o.toUpperCase();let a=0;return i>s?a=1:i<s&&(a=-1),a}}class ge{static async read(e){console.log(`[read] filename=${e}`);const t=new URLSearchParams;return t.append("filename",e),ge.post_cmdEx("load_file_md",t)}static write(e,t){console.log(`[write] filename=${e}`);const n=new URLSearchParams;return n.append("filename",e),n.append("source",t),ge.post_cmdEx("save_file_md",n)}static async get_cmdEx(e){const t="http://localhost:5000/api/viewer/"+e;return console.log(`[store_RST:get_cmdEx] api=${t}`),l.get(t).then((e=>e.data)).catch((e=>{throw e.response.status}))}static async post_cmdEx(e,t){const n="http://localhost:5000/api/viewer/"+e;return console.log(`[store_RST:post_cmdEx] api=${n}`),l.post(n,t).then((e=>e.data)).catch((e=>{throw e.response.status}))}}class pe{constructor(e){this._=e}backupEx(e,t,n){switch(console.log(`[backup] mode=${t}`),t){case"backup":!function(){const t=new URLSearchParams;t.append("lstContent",JSON.stringify(e)),ge.post_cmdEx("backup_contents",t).then((e=>console.log(e))).catch((e=>console.log(e)))}();break;case"export":!function(){const t=new Blob([JSON.stringify(e)],{type:"text/plain"}),n=document.createElement("a");n.download="lstData.json",n.href=URL.createObjectURL(t),n.click(),URL.revokeObjectURL(n.href)}();break;case"cloud_save":!function(t){const n=new Blob([JSON.stringify(e)],{type:"application/oden"}),o=`${t}/dct_oden.json`;console.log(o);var i=c(r(),o);console.log(i),d(i,n)}(n)}}async restoreEx(e,t,n){function o(e){e.forEach((e=>{const t=new re;t.copy(e),t.update_contentEx(),t.update_time(),i.write(t.path,t)}))}console.log("[importExport:restore]");const i=this._.contentEx;return new Promise((function(i,s){switch(e){case"restore":!async function(e,t){ge.get_cmdEx("restore_contents").then((t=>{o(t),e(t)})).catch((e=>{console.log(e),t(null)}))}(i,s);break;case"import":!async function(e,t,n){const i=new FileReader;i.onload=()=>{var e;console.log("onload");const n=null!=(e=i.result)?e:"",s=JSON.parse(n);o(s),t(s)},i.onerror=e=>{n("error")},i.readAsText(e)}(t,i,s);break;case"cloud_load":!async function(e,t,n,i){const s=`${i}/dct_oden.json`;console.log(s);var a=c(r(),s);const l=await u(a),d=await fetch(l);console.log(l);const m=await d.json();o(m),t(m)}(0,i,0,n)}}))}}class _e{constructor(e){this.journal2=async(e,t)=>{console.log("[journal]");const n=await this.geolocation();return e.content+=((e,n)=>`\n## ${this._.contentEx.as(e).cnv_time(t)}\n${n}\n`)(e,n),e},this.geolocation=()=>new Promise((e=>{let t="";navigator.geolocation?navigator.geolocation.getCurrentPosition((n=>{t=`(Latitude,longitude)=(${n.coords.latitude},${n.coords.longitude})\n`,e(t)}),(n=>{switch(n.code){case 1:t="<li>位置情報の利用が許可されていません</li>";break;case 2:t="<li>デバイスの位置が判定できませんでした</li>";break;case 3:t="<li>タイムアウトが発生しました</li>"}e(t)})):(window.alert("<li>Geolocation APIが搭載されていないブラウザです。</li>"),e(t))})),this.chat=async(e,t,n)=>{console.log("[chat]");const o=e.content.indexOf("\n"),[i,s]=(e=>{const t=e=>`00${e}`.slice(-2);var n;return[`${e.getFullYear()}/${t(e.getMonth()+1)}/${t(e.getDate())}(${n=e.getDay(),["sun","mon","tue","wed","thu","fri","sat"][n]})`,`${t(e.getHours())}:${t(e.getMinutes())}`]})(new Date),a=n.isAddGeo?await this.geolocation()+"\n":"",l=(e.content.substring(0,o)!==(r=i)?`\n## ${r}\n`:"")+(c=s,`${n.isNoList?"":"- "}${n.isAddTime?`${c} : `:""}${t}\n${a}`);var c,r;return e.content=`${i}${e.content.substring(o)}${l}`,e},this._=e}async path_rename(e,t,n){console.log(`_from=${e}, _to=${t}`);const o=this.collect_filename_by_group(e,n);for(let i=0;i<o.length;i++){const e=o[i],n=`${e[1]}/${e[0]}`,s=`${t}${e[2]}/${e[0]}`;await this._.contentEx.rename(n,s)}}async path_delete(e,t){console.log(`_path=${e}`);const n=this.collect_filename_by_group(e,t);for(let o=0;o<n.length;o++){const e=n[o],t=`${e[1]}/${e[0]}`;await this._.contentEx.delete(t)}}async path_merge(e,t,n){console.log(`_path=${e}`);const o=[],i=this.collect_filename_by_group(e,n);for(let a=0;a<i.length;a++){const e=i[a],t=`${e[1]}/${e[0]}`,n=await this._.contentEx.get(t);o.push(n.content)}const s=o.join("\r\n");return this._.contentEx.merge(t,s)}collect_filename_by_group(e,t){console.log(`[collect_filename_by_group] group=${e}`);const n=[],o=0!=e.length?1:0;return t.forEach(((t,i)=>{if(t.group==e){const i=t.group.substring(e.length+o);n.push([t.title,t.group,0!=i.length?`/${i}`:""])}})),n}}class be{constructor(e){this._=e}async getLstContent(e){console.log("[getLstContent]");const t=await this.buildLstContent();return null!=e?t.filter((t=>{const n=""==e.path||-1!=t.path.indexOf(e.path),o=-1!=t.content.toLowerCase().indexOf(e.keyword);return n&&o})):t}async buildLstContent(){var e;console.log("[buildLstContent]");const t=e=>{var t,n;let o=e.path;""!=o&&null!=o||(o=`@test/${(new Date).toLocaleString()}`);const i=o.split("/");return e.title=null!=(t=i.pop())?t:".",e.group=null!=(n=i.join("/"))?n:"@test",e},n=await this._.contentEx.storeLS.getStrageEx(),o=[];for(const s of Object.keys(n))try{o.push(t(JSON.parse(null!=(e=n[s])?e:"")))}catch(i){console.log(`@ error key=${s},e=${i} - other error`)}return o}}class ve{constructor(){this.contentEx=new me(this),this.mgrExchange=new pe(this),this.mgrEtc=new _e(this),this.mgrMenu=new he(this),this.mgrCache=new be(this),console.log("[constructor]")}async cmd_getMenu(e=null){return this.mgrMenu.getMenu(e)}async cmd_load(e){return this.contentEx.get(e)}async cmd_create(e){return await this.contentEx.get(e)}async cmd_save(e,t){return this.contentEx.set(e,t)}async cmd_delete(e){await this.contentEx.delete(e)}async cmd_rename(e,t){await this.contentEx.rename(e,t)}async cmd_update_position(e,t){return this.contentEx.update_position(e,t)}async cmd_exist(e){return this.contentEx.exist(e)}async cmd_backup(e,t=""){const n=await this.mgrCache.buildLstContent();this.mgrExchange.backupEx(n,e,t)}async cmd_restoreEx(e,t,n=""){await this.mgrExchange.restoreEx(e,t,n)}async cmd_rebuild(){return this.mgrMenu.rebuildMenu()}async cmd_split(e){await this.contentEx.split(e)}async cmd_path_rename(e,t){const n=await this.cmd_getMenu();await this.mgrEtc.path_rename(e,t,n)}async cmd_path_delete(e){const t=await this.cmd_getMenu();await this.mgrEtc.path_delete(e,t)}async cmd_path_merge(e,t){const n=await this.cmd_getMenu();await this.mgrEtc.path_merge(e,t,n)}async cmd_chat(e,t,n){const o=(()=>{const t=new Date;return`${e}${n.mode}_${t.getFullYear()}${o=t.getMonth()+1,`00${o}`.slice(-2)}.md`;var o})();console.log(`[cmd_chat] filename= ${o}`);const i=await this.contentEx.get(o),s=await this.mgrEtc.chat(i,t,n);return await this.contentEx.set(o,s.content),[s,o]}}class fe{constructor(e){this.KEY="",console.log(e),this.KEY=e}get(e){var t;if(null!=localStorage.getItem(this.KEY)){const n=JSON.parse(null!=(t=localStorage.getItem(this.KEY))?t:"");e(n),console.log(n)}}set(e){localStorage.setItem(this.KEY,JSON.stringify(e)),console.log(e)}}const ke=Symbol("authStore"),we=()=>{const e=_(ke);if(!e)throw new Error(`${ke} is not provided`);return e},ye=Symbol(),Ee=()=>{const e=v(),t=f(),n=m({storeEx:new ve,persisted:new fe("lifeLog-Viewer-params"),filename:"",obj:new re,code:"",tags:[],isViewer:!1,dictMenu:[],ObjTag:[],jump:-1,height:500,path_expand:"(o_o)/"}),{state_auth:o}=we(),i=e=>{console.log(`[update_filename] : new=${e}`),e!=n.filename&&(n.filename=e,s(e))},s=o=>{const i=o=>{-1==t.path.indexOf(o)&&(console.log(`_value=${o}`),e.push(`/${o}`)),n.persisted.set({filename:o})};if(console.log(`[load_obj] : new=${o}`),""==o)return l(""),void i(o);n.storeEx.cmd_load(o).then((e=>{const t=Object.assign(new re,e);a(t),i(o)})).catch((e=>{console.log("error")}))},a=(e,t=!0)=>{const o=e instanceof re?e:Object.assign(new re,e);n.obj=o,o.update_tag(),l(o.content),n.tags=o.tags,t&&c(n.dictMenu)},l=e=>{n.code=e},c=e=>{n.dictMenu=e},r=async(e,t)=>{null!=e&&a(e,!1),setTimeout((async()=>{c(await n.storeEx.cmd_rebuild())}),500),null!=t&&i(t)},d=e=>{const t=e.split("/"),n=t[t.length-1];return[t.slice(0,-1).join("/"),n]};return{store_data:{state:n,update_height:e=>{n.height=e},save_code:async e=>{""!=e&&r(await n.storeEx.cmd_save(n.filename,e),void 0)},do_cmd:async(t,s,a)=>{const l=async(e,t)=>{if(t==await n.storeEx.cmd_exist(e))return!0;{const n=t?`error : ${e} is not exist. please enter exist filename.`:`error : ${e} is already exist. please enter other filename.`;return console.log(n),!1}};console.log(`[do_cmd] mode=${t},value=${s},value2=${a}`);let u,m,h,g=""!=s?s:n.filename,p="";switch(t){case"update_jump":_=s,n.jump=_,n.ObjTag=JSON.parse(JSON.stringify(n.tags[_]));break;case"rebuild_menu":c(await n.storeEx.cmd_rebuild());break;case"filter_menu":const t=s;null!=s&&(t.path=t.isUnderFolder?d(n.filename)[0]:""),c(await n.storeEx.cmd_getMenu(t));break;case"open_file":i(s);break;case"restore_file":console.log("restore_filename"),n.persisted.get((e=>{i(e.filename)}));break;case"new":await l(s,!1)&&(await n.storeEx.cmd_create(s),r(null,s));break;case"delete":await l(g,!0)&&(await n.storeEx.cmd_delete(g),r(null,""));break;case"rename":await l(s,!1)&&(await n.storeEx.cmd_rename(a,s),r(null,s));break;case"backup":n.storeEx.cmd_backup("backup");break;case"export":n.storeEx.cmd_backup("export");break;case"cloud_save":n.storeEx.cmd_backup("cloud_save",o.uid);break;case"restore":await n.storeEx.cmd_restoreEx("restore",null),r(null,void 0);break;case"import":await n.storeEx.cmd_restoreEx("import",s),r(null,void 0);break;case"cloud_load":await n.storeEx.cmd_restoreEx("cloud_load",s,o.uid),r(null,void 0);break;case"split":await l(g,!0)&&(await n.storeEx.cmd_split(g),r(null,void 0));break;case"path_rename":const b=d(a)[0],v=d(s)[0];await n.storeEx.cmd_path_rename(b,v),r(null,"");break;case"path_delete":p=d(s)[0],await n.storeEx.cmd_path_delete(p),r(null,"");break;case"path_merge":p=d(s)[0],g=`${p}.md`,await l(g,!1)&&(await n.storeEx.cmd_path_merge(p,g),r(null,g));break;case"print":const f=e.resolve({path:`/print/${n.filename}`});window.open(f.href,"_blank");break;case"journal":m={mode:"journal",isAddGeo:!0,isAddTime:!0},[u,g]=await n.storeEx.cmd_chat(n.path_expand,"",m),r(u,g);break;case"tweet":m={mode:"tweet",isAddGeo:!1,isAddTime:!0},[u,g]=await n.storeEx.cmd_chat(n.path_expand,s,m),r(u,g);break;case"bookmark":m={mode:"bookmark",isAddGeo:!1,isAddTime:!1,isNoList:!0},[u,g]=await n.storeEx.cmd_chat(n.path_expand,s,m),r(u,g);break;case"filter":h={keyword:a.filter,isUnderFolder:a.isCheck,path:""},c(await n.storeEx.cmd_getMenu(h));break;case"update_position":(async e=>{await n.storeEx.cmd_update_position(n.filename,e)})(s)}var _}}}},xe=()=>_(ye),$e=Symbol(),Ce=()=>{b($e,(()=>{const e=m({objParam:null});return{store_dlg:{state:e,update_param:t=>{e.objParam=t}}}})())},Me=()=>_($e);var Se=k({components:{},setup:()=>(b(ye,Ee()),Ce(),{})});Se.render=function(e,t,n,o,i,s){const a=w("routerView");return E(),y(a)};var Oe=k({emits:["event_callback"],props:{item:{type:Object,default:{}}},setup(e,t){const n=m({isOpen:!1,item:e.item,isFolder:e.item.children&&e.item.children.length,isActive:!0});const o=(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)};return{state:n,onClick:function(e){if(n.isFolder)console.log("onClick-folder"),n.isOpen=!n.isOpen;else{const t=e.cmd;o(t,null)}},event_callback:o}}});x("data-v-af6b6e1a");const je={key:0,class:"item"},Le={key:1,class:"folder"},Te={key:2,class:"dropdown"};$(),Oe.render=function(e,t,n,o,i,s){const a=w("fa"),l=w("MenuTreeItem",!0);return E(),C("div",{class:"menu_tree",onClick:t[0]||(t[0]=t=>e.onClick(e.state.item)),onContextmenu:t[1]||(t[1]=D((()=>{}),["right","prevent"]))},[e.state.isFolder?j("",!0):(E(),C("span",je,[M(a,{icon:e.state.item.icon},null,8,["icon"]),S(" "+O(e.state.item.title),1)])),e.state.isFolder?(E(),C("span",Le,[M(a,{icon:e.state.item.icon},null,8,["icon"]),S(" ["+O(e.state.item.title)+"] ",1)])):j("",!0),e.state.isFolder?(E(),C("div",Te,[(E(!0),C(L,null,T(e.state.item.children,((t,n)=>(E(),C("div",{key:n},[M(l,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))])):j("",!0)],32)},Oe.__scopeId="data-v-af6b6e1a";var De=k({emits:["event_callback"],components:{MenuTreeItem:Oe},props:{mouse:{type:PointerEvent,default:{}},items:{type:Array,default:[]}},setup(e,t){const n=m({items:e.items,pos_x:-1,pos_y:-1,isShow:!1,style:"display:none"});A((()=>e.mouse),((t,o)=>{console.log("props"),n.isShow=!0,n.pos_x=e.mouse.clientX,n.pos_y=e.mouse.clientY,n.items=e.items,n.style="display:block"}));return{state:n,event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)},mouse_hover:function(e){n.style=e?"display:block":"display:none"}}}});De.render=function(e,t,n,o,i,s){const a=w("MenuTreeItem");return E(),C("div",{class:"menu",style:N(e.state.style),onMouseover:t[0]||(t[0]=t=>e.mouse_hover(!0)),onMouseleave:t[1]||(t[1]=t=>e.mouse_hover(!1))},[(E(!0),C(L,null,T(e.state.items,(t=>(E(),C("div",{key:t.path},[M(a,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))],36)},De.__scopeId="data-v-680ebf40";var Ae=k({emits:["event_callback"],components:{MenuTree:De},props:{objMenu:{type:Array,default:[]}},setup(e,t){const n=m({items:e.objMenu,event:void 0});return{state:n,onClick:function(e){console.log("onClick"),n.event=e},event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)}}}});Ae.render=function(e,t,n,o,i,s){const a=w("fa"),l=w("MenuTree");return E(),C("div",{class:"dropdown",onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},[M(a,{icon:"bars"}),M(l,{mouse:e.state.event,items:e.state.items,onEvent_callback:e.event_callback},null,8,["mouse","items","onEvent_callback"])])},Ae.__scopeId="data-v-3a47341c";var Ne=k({emits:["event_callback"],props:{objMenuItem:{type:Array,default:[]}},setup(e,t){const n=m({items:[],isShowDlg:!1});A((()=>e.objMenuItem),((e,t)=>{n.items=function(e){function t(e,t){const n=e.atime,o=t.atime;let i=0;return n>o?i=-1:n<o&&(i=1),i}console.log("[cnvLstRecent]");const n=[...e];return n.sort(t),n.slice(0,15)}(e)}));return{state:n,mouse_hover:function(e){n.isShowDlg=e},select_file:function(e){const o=n.items[e].path;t.emit("event_callback","open_file",o),n.isShowDlg=!1},tooltip:e=>`${e.title}/${e.group}`}}});x("data-v-4be6d922");const Ie={key:0,class:"dropdown"},Re=["onClick"],Fe={class:"title_sub2"},Be={class:"title"},Ve={class:"title_sub"};$(),Ne.render=function(e,t,n,o,i,s){const a=w("fa");return E(),C("span",{class:"_base",onMouseover:t[0]||(t[0]=t=>e.mouse_hover(!0)),onMouseleave:t[1]||(t[1]=t=>e.mouse_hover(!1))},[M(a,{icon:"history",class:"_item"}),e.state.isShowDlg?(E(),C("ul",Ie,[(E(!0),C(L,null,T(e.state.items,((t,n)=>(E(),C("li",{class:"item",key:n,onClick:t=>e.select_file(n)},[M(a,{class:"title_item",icon:"file-alt"}),I("span",Fe,O(t.group)+"/ ",1),I("span",Be,O(t.title),1),I("span",Ve," ["+O(t.atime)+"]",1)],8,Re)))),128))])):j("",!0)],32)},Ne.__scopeId="data-v-4be6d922";const Pe=[{title:"new",cmd:"dlg_new",icon:"file",children:[]},{title:"chat",icon:"",cmd:"",children:[{title:"tweet",cmd:"dlg_tweet",icon:"file",children:[]},{title:"journal",cmd:"journal",icon:"file",children:[]}]},{title:"",cmd:"",icon:"minus",children:[]},{title:"bacup/restore",icon:"",cmd:"",children:[{title:"backup",cmd:"backup",icon:"cloud-upload-alt",children:[]},{title:"restore",cmd:"restore",icon:"cloud-download-alt",children:[]}]},{title:"export/import",icon:"",cmd:"",children:[{title:"export",cmd:"export",icon:"file-export",children:[]},{title:"import",cmd:"dlg_import",icon:"file-import",children:[]}]},{title:"cloud",icon:"",cmd:"",children:[{title:"save",cmd:"cloud_save",icon:"file-export",children:[]},{title:"load",cmd:"cloud_load",icon:"file-import",children:[]}]},{title:"filter",cmd:"dlg_filter",icon:"paw",children:[]},{title:"config",cmd:"config",icon:"paw",children:[]},{title:"print",cmd:"print",icon:"print",children:[]}],He=[{title:"new",cmd:"dlg_new",icon:"file",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"rename",cmd:"dlg_rename",icon:"pen",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"delete",cmd:"dlg_delete",icon:"trash-alt",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"split",cmd:"split",icon:"file",children:[]}],Ue=[{title:"path_rename",cmd:"dlg_path_rename",icon:"sync",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"path_delete",cmd:"dlg_path_delete",icon:"sync",children:[]},{title:"",cmd:"",icon:"minus",children:[]},{title:"path_merge",cmd:"dlg_path_merge",icon:"file",children:[]}],Je={dlg_import:{init:(e,t)=>{e.title="Restore",e.isFileOpen=!0,e.isNoEdit=!0,e.edit=""},action:e=>["import"]},dlg_delete:{init:(e,t)=>{e.title="Delete",e.isReadOnly=!0,e.edit=t},action:e=>["delete",e.edit,""]},dlg_rename:{init:(e,t)=>{e.title="Rename",e.edit=t},action:e=>["rename",e.edit,e.edit_org]},dlg_new:{init:(e,t)=>{e.title="Create",e.edit=t.split("/").slice(0,-1).join("/")+"/*.md"},action:e=>["new",e.edit,""]},dlg_path_rename:{init:(e,t)=>{e.title="Rename of Path",e.edit=t.split("/").slice(0,-1).join("/")+"/"},action:e=>["path_rename",e.edit,e.edit_org]},dlg_path_delete:{init:(e,t)=>{e.title="Delete of Path",e.isReadOnly=!0,e.edit=t.split("/").slice(0,-1).join("/")+"/"},action:e=>["path_delete",e.edit,""]},dlg_path_merge:{init:(e,t)=>{e.title="Merge of Path",e.isReadOnly=!0,e.edit=t.split("/").slice(0,-1).join("/")+"/"},action:e=>["path_merge",e.edit,""]},dlg_tweet:{init:(e,t)=>{e.title="Tweet",e.edit=""},action:e=>["tweet",e.edit,""]},dlg_bookmark:{init:(e,t)=>{e.title="Bookmark",e.edit="",e.isMulti=!0},action:e=>["bookmark",e.edit,""]},dlg_filter:{init:(e,t)=>{e.title="Filter",e.title2="target under folder",e.edit="",e.edit_org="@",e.isCheck=!0},action:e=>(console.log("dlg_filter"),["filter",e.filename,{filter:e.edit,isCheck:e.check}])}};var qe=k({emits:["event_callback"],components:{MenuCmd:Ae,MenuRecent2:Ne},setup(e,t){const{store_data:n}=xe();Me();const{state_auth:o,signin:i,signout:s}=we(),a=R(null),l=m({filename:"@",objMenu:Pe,dctMenu:[]});F((()=>{console.log("[mounted]")}));A((()=>n.state.filename),((e,t)=>{console.log(`[watch:filename] ${e}`),r(e)})),A((()=>n.state.dictMenu),((e,t)=>{l.dctMenu=e})),A((()=>n.state.jump),((e,t)=>{window.setTimeout((()=>{c()}),500)}));const c=()=>{a.value.scrollIntoView({})},r=e=>{console.log(`[onChanged_filename] new=${e}`),l.filename=e,c()};return{state:l,state_auth:o,sign_in_out:()=>{o.isLoggedin?s():i()},doAction:e=>{console.log(`[doAction] cmd=${e}`),t.emit("event_callback",e,!0)},event_callback:(e,n)=>{if(console.log(`[event_callback] cmd=${e}`),"top"==e){a.value.scrollIntoView({})}else t.emit("event_callback",e,n)},appbar:a}}});x("data-v-6bf5fa8b");const Ke={class:"nav"},Ye=["title"],Ge={class:"cmd"};$(),qe.render=function(e,t,n,o,i,s){const a=w("MenuCmd"),l=w("MenuRecent2"),c=w("fa");return E(),C("header",{class:"appbar",ref:"appbar",onClick:t[7]||(t[7]=t=>e.event_callback("top",!0))},[I("nav",Ke,[M(a,{class:"item",objMenu:e.state.objMenu,onEvent_callback:e.event_callback,title:"menu"},null,8,["objMenu","onEvent_callback"]),I("section",{class:"item logo",onClick:t[0]||(t[0]=t=>e.event_callback("filelist",!0)),title:e.state.filename},"Oden",8,Ye),M(l,{class:"item",objMenuItem:e.state.dctMenu,onEvent_callback:e.event_callback,title:"history"},null,8,["objMenuItem","onEvent_callback"]),""!==e.state.filename?(E(),C("span",{key:0,class:"item name",onClick:t[1]||(t[1]=t=>e.event_callback("dlg_rename",null))}," ["+O(e.state.filename)+"] ",1)):j("",!0),I("span",{class:"item mark",onClick:t[2]||(t[2]=t=>e.doAction("toggle_editor")),title:"editor/viewer"},[M(c,{icon:"edit"})])]),I("span",Ge,[I("span",{class:"item",onClick:t[3]||(t[3]=t=>e.doAction("dlg_filter")),title:"filter"},[M(c,{icon:"paw"})]),I("span",{class:"item",onClick:t[4]||(t[4]=t=>e.doAction("dlg_tweet")),title:"tweet"},[M(c,{icon:"grimace"})]),I("span",{class:"item",onClick:t[5]||(t[5]=t=>e.doAction("dlg_bookmark")),title:"bookmark"},[M(c,{icon:"bookmark"})]),I("button",{type:"button",class:"button is-small is-info is-outlined",onClick:t[6]||(t[6]=t=>e.sign_in_out()),title:"sign in/out"},[I("span",null,O(e.state_auth.isLoggedin?e.state_auth.displayName:"guest"),1)])])],512)},qe.__scopeId="data-v-6bf5fa8b";var ze=k({emits:["event_callback"],components:{MenuTree:De},props:{item:{type:Object,default:{}}},setup(e,t){const{store_data:n}=xe(),o=m({isOpen:!1,item:e.item,isFolder:e.item.children&&e.item.children.length,menu:[],event:null,class_item:"item"});A((()=>n.state.filename),((e,t)=>{i(e)}));const i=e=>{o.item.path;-1!=e.indexOf(o.item.name)&&(o.isOpen=!0),o.class_item=o.item.path==e?"item active":"item"};return F((()=>{i(n.state.filename)})),{state:o,onClick:function(e){if(o.isFolder)console.log("onClick-folder"),o.isOpen=!o.isOpen;else{const t=e.path;console.log(`onClick-filename=${t}`),n.do_cmd("open_file",t)}},onClickEx:function(e){console.log("onClickEx"),o.menu=o.isFolder?Ue:He,o.event=e},event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)},event_callbackEx:(e,n)=>{console.log(`[event_callbackEx] cmd=${e}`);const i=o.item.path;t.emit("event_callback",e,i)}}}});x("data-v-736aab12");const We={class:"file_tree"},Xe=["title"],Ze={key:1,class:"folder"},Qe={key:0};$(),ze.render=function(e,t,n,o,i,s){const a=w("MenuTree"),l=w("fa"),c=w("tree-item",!0);return E(),C("div",We,[M(a,{mouse:e.state.event,items:e.state.menu,onEvent_callback:e.event_callbackEx},null,8,["mouse","items","onEvent_callback"]),I("div",{onContextmenu:t[0]||(t[0]=D(((...t)=>e.onClickEx&&e.onClickEx(...t)),["prevent"])),onClick:t[1]||(t[1]=t=>e.onClick(e.state.item))},[e.state.isFolder?j("",!0):(E(),C("div",{key:0,class:B(e.state.class_item),title:e.state.item.time},O(e.state.item.name),11,Xe)),e.state.isFolder?(E(),C("div",Ze,[M(l,{icon:e.state.isOpen?"folder-open":"folder"},null,8,["icon"]),S(" "+O(e.state.item.name),1)])):j("",!0)],32),e.state.isOpen?(E(),C("div",Qe,[(E(!0),C(L,null,T(e.state.item.children,((t,n)=>(E(),C("div",{key:n},[M(c,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))])):j("",!0)])},ze.__scopeId="data-v-736aab12";var et=k({emits:["event_callback"],components:{TreeItem:ze},setup(e,t){console.log("setup");const{store_data:n}=xe(),o=m({items:void 0});function i(e){console.log("[onChanged_dictMenu]"),o.items=void 0;const t={name:"",children:[],path:"",file:""},n="/",i={[n]:t};e.forEach((function(e){e.key.split("/").reduce((function(t,o){if(t[o])return t[o];{const i={name:o,children:[],path:e.path,file:"md",time:e.atime};return t["/"].children.push(i),t["/"].file="",t[o]={[n]:i}}}),i)})),console.log(t),setTimeout((()=>{o.items=t.children}),500)}F((()=>{console.log("[mounted]"),i(n.state.dictMenu)})),A((()=>n.state.dictMenu),((e,t)=>{i(e)}));return{state:o,event_callback:(e,n)=>{console.log(`[event_callback] cmd=${e}`),t.emit("event_callback",e,n)}}}});x("data-v-1f034d00");const tt={class:"tree"};$(),et.render=function(e,t,n,o,i,s){const a=w("tree-item");return E(),C("div",tt,[(E(!0),C(L,null,T(e.state.items,(t=>(E(),C("div",{key:t.path},[M(a,{item:t,onEvent_callback:e.event_callback},null,8,["item","onEvent_callback"])])))),128))])},et.__scopeId="data-v-1f034d00";var nt=k({props:{level:{type:Number,required:!0}},setup:(e,t)=>({tag:V((()=>`h${e.level}`))})});nt.render=function(e,t,n,o,i,s){return E(),y(H(e.tag),{class:"h_tag"},{default:P((()=>[U(e.$slots,"default",{},void 0,!0)])),_:3})},nt.__scopeId="data-v-1765be40";var ot=k({emits:["event_callback"],components:{heading:nt},setup(e,t){const{store_data:n}=xe(),o=m({listTag:[]});return A((()=>n.state.tags),((e,t)=>{console.log(e),o.listTag=e})),{state:o,dispTitle:function(e){return`${e.text}`},jumpSource:function(e){n.do_cmd("update_jump",e)}}}});x("data-v-1d58b53a");const it={class:"tag"},st=["onClick"];$(),ot.render=function(e,t,n,o,i,s){const a=w("heading");return E(),C("div",it,[(E(!0),C(L,null,T(e.state.listTag,((t,n)=>(E(),C("div",{key:n,onClick:t=>e.jumpSource(n),class:"item"},[M(a,{level:t.tag},{default:P((()=>[S(O(e.dispTitle(t)),1)])),_:2},1032,["level"])],8,st)))),128))])},ot.__scopeId="data-v-1d58b53a";var at=k({emits:["event_callback"],setup:(e,t)=>({objToolbar:[{icon:"bold",cmd:"Bold"},{icon:"italic",cmd:"Italic"},{icon:"underline",cmd:"Underline"},{icon:"strikethrough",cmd:"Strikethrough"},{icon:"code",cmd:"Code"},{icon:"check-square",cmd:"Check"},{icon:"table",cmd:"Table"},{icon:"link",cmd:"Link"},{icon:"chevron-right",cmd:"Blockquotes"},{icon:"paint-roller",cmd:"ColorText"},{icon:"calendar",cmd:"Today"},{icon:"expand",cmd:"Expand"},{icon:"bolt",cmd:"Format"}],event_callback:(e,n)=>{console.log(`cmd=${e}, name=${n}`),t.emit("event_callback",e,n)}})});x("data-v-2dca080d");const lt={class:"main",style:{_height:"100px"}},ct=["onClick","title"];$(),at.render=function(e,t,n,o,i,s){const a=w("fa");return E(),C("div",lt,[(E(!0),C(L,null,T(e.objToolbar,((t,n)=>(E(),C("button",{class:"btn-item",key:n,onClick:n=>e.event_callback("action",t.cmd),title:t.cmd},[M(a,{icon:t.icon},null,8,["icon"])],8,ct)))),128))])},at.__scopeId="data-v-2dca080d";const rt={};class dt{constructor(e,n){t(this,"cmdid",0),t(this,"monaco",null),t(this,"editor",null),console.log("[constructer]"),this.monaco=e,this.editor=n}add(e,t,n,o,i=null){let s;switch(o.length){case 0:s=this.generateCommand(e,i);break;case 1:s=this.generateHeaderCommand(o[0]);break;case 2:s=this.generateWrapperCommand(o[0],o[1])}rt[e]=s,this.editor.addAction({id:"markdown-"+this.cmdid++,label:e,keybindings:n,contextMenuGroupId:t&&"navigation",contextMenuOrder:t&&1.5,run:rt[e]})}generateCommand(e,t){return(e,n)=>{t(e)}}generateWrapperCommand(e,t){const n=e.length+t.length;return this.editor,this.editor.getModel(),this.monaco,(o,i)=>{const s=o.getModel(),a=o.getSelections();if(null==a)return;const l=[];return a.forEach((o=>{l.push(new i.Selection(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn+n)),s.pushEditOperations([],[{range:{startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.startLineNumber,endColumn:o.startColumn},text:e},{range:{startLineNumber:o.endLineNumber,startColumn:o.endColumn,endLineNumber:o.endLineNumber,endColumn:o.endColumn},text:t}])})),o.setSelections(l),null}}generateHeaderCommand(e){return this.editor,this.editor.getModel(),(t,n)=>{const o=t.getModel();let i=t.getSelections();return null==i&&(i=[t.getSelection()]),i.forEach((t=>{const n=o.findNextMatch("^(#+ )",{lineNumber:t.startLineNumber,column:1},!0,!1,null,!0);if(null!=n&&n.range.startLineNumber==t.startLineNumber&&1==n.range.startColumn){if(n.matches[1]==e)return;o.pushEditOperations([],[{range:{startLineNumber:t.startLineNumber,startColumn:1,endLineNumber:t.startLineNumber,endColumn:n.matches[1].length+1},text:""}])}o.pushEditOperations([],[{range:{startLineNumber:t.startLineNumber,startColumn:1,endLineNumber:t.startLineNumber,endColumn:1},text:e}])})),null}}}const ut={lineNumbersMinChars:4,minimap:{enabled:!0},wordWrap:"on",renderWhitespace:"all",selectOnLineNumbers:!0,automaticLayout:!0,fontSize:16,scrollBeyondLastLine:!1,language:"markdown",theme:"vs",autoIndent:!0,formatOnPaste:!0,formatOnType:!0};var mt=k({emits:["event_callback"],components:{ToolbarEditor:at},props:{isActive_preview:{type:Boolean,default:!1}},setup(e,t){const n=R(null),o={editor:void 0},{store_data:i}=xe(),s=m({iVersion:-1,scrollInfo:{height:0,top:0},isScrolled:!1});F((()=>{console.log("[mounted]"),l(),u(i.state.code)})),A((()=>i.state.code),((e,t)=>{console.log("[watch-body]"),u(e),g(i.state.obj.position),s.isScrolled=!1})),A((()=>i.state.ObjTag),((e,t)=>{console.log(`[watch](ObjTag)-${e}`),a(e)}));const a=e=>{console.log(`[jump_cursor]ObjTag={${Object.values(e)}}`);const t=e.line;r(t),setTimeout((()=>{s.isScrolled=!1}),1e3)},l=()=>{o.editor=(()=>{const e=document.getElementById("container");if(console.log(`root=${e}`),null==e)return;const t=J.create(e,ut);return function(e,t){console.log("[setupShortcutKeys]");const n=new dt(e,t);n.add("Bold","8_",[],["**","**"]),n.add("Italic","1_",[],["__","__"]),n.add("Underline","9_",[],["<u>","</u>"]),n.add("Strikethrough",!1,[e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KEY_S],["~~","~~"]),n.add("Code",!1,[],["`","`"]),n.add("Link",!1,[],["[","]()"]),n.add("Link-2",!1,[],["[](",")"]),n.add("ColorText",!1,[],['<span style="color: red; ">',"</span>"]),n.add("Expand",!1,[],["<details><summary>",["</summary>","</details>"].join("\n")]),n.add("Header 1",!1,[],["# ",""]),n.add("Header 2",!1,[],["## ",""]),n.add("Header 3",!1,[],["### ",""]),n.add("Header 4",!1,[],["#### ",""]),n.add("Header 5",!1,[],["##### ",""]),n.add("Header 6",!1,[],["###### ",""]),n.add("Check",!1,[],["- [ ] ",""]),n.add("Blockquotes",!1,[],["> ",""]),n.add("Today",!1,[],[`${(e=>{const t=e=>`00${e}`.slice(-2);return`${e.getFullYear()}/${t(e.getMonth()+1)}/${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`})(new Date)}`,""]),n.add("Table",!1,[],[["| Column | Column | Column |","| ------ | ------ | ------ |","| Text   | Text   | Text   |",""].join("\n"),""]),n.add("Format","8_",[],[],(e=>{console.log("format"),e.getAction("editor.action.formatDocument").run()}))}(q,t),console.log(`editor=${t}`),t.onDidScrollChange((e=>{s.scrollInfo.height=e.scrollHeight,s.scrollInfo.top=e.scrollTop,s.isScrolled=!0})),t})()},c=e=>{console.log("[action]"),null!=rt[e]&&rt[e](o.editor,q)},r=e=>{const t=new K(e+1,0,e+1,0);console.log(`Line=${e}`),o.editor.revealRangeAtTop(t)},d=()=>o.editor.getModel().getAlternativeVersionId(),u=e=>{console.log("[watch-body]"),o.editor.setValue(e),s.iVersion=d()},h=()=>{console.info("[save_content]");const e=d();if(console.info(`iVersion=${s.iVersion}, iVersion_cur=${e}`),s.iVersion==e)return;const t=o.editor.getValue();i.save_code(t),s.iVersion=d(),console.info(`iVersion=${s.iVersion}`)},g=e=>{if(null==e)return;console.log(`[e-set]value=${JSON.stringify(e)}`);const t=e.top/e.height;console.log(`per=${t}`);const n=o.editor.getScrollHeight();o.editor.setScrollTop(n*t)},p=V((()=>i.state.height-27+"px"));return{editorEx:o,event_callback:(e,t)=>{switch(console.log(`[event_callback] cmd=${e}`),e){case"action":c(t);break;case"save":h()}},HeightEx:p,md_editor_monaco:n,get_position:()=>{h();const e=o.editor,t={top:e.getScrollTop(),height:e.getScrollHeight(),scrolled:s.isScrolled};return i.do_cmd("update_position",t),t},set_position:g}}});x("data-v-1dc20672");const ht={class:"editor"};$(),mt.render=function(e,t,n,o,i,s){const a=w("ToolbarEditor");return E(),C("div",ht,[M(a,{class:"toolbar",onEvent_callback:e.event_callback},null,8,["onEvent_callback"]),I("div",{id:"container",ref:"md_editor_monaco",class:"core",style:N({height:e.HeightEx})},null,4)])},mt.__scopeId="data-v-1dc20672";var gt=k({components:{},props:{isActive_preview:{type:Boolean,default:!1}},setup(e,t){const n=R(null),{store_data:o}=xe(),i=m({isScrolled:!1,contentsPosition:[],tocMap:new Map,observer:null,elm_target_before:null});F((()=>{console.log("[created]"),function(){const e=new Y.Renderer;e.link=function(e,t,n){return-1!=e.indexOf("http")?`<a target="_blank" href="${e}">${n}</a>`:`<a target="_blank" href="#${e}">${n}</a>`},Y.setOptions({renderer:e,langPrefix:"",breaks:!0})}()})),A((()=>o.state.code),((e,t)=>{console.log("[watch-body]"),n.value,setTimeout((()=>{i.isScrolled=!1,function(){const e=e=>{e.forEach((e=>{const t=i.tocMap.get(e.target);e.intersectionRatio?(null!=i.elm_target_before&&i.elm_target_before.classList.remove("active"),t.classList.add("active"),i.elm_target_before=null):i.elm_target_before=t}))},t={root:document.querySelector(".md_core_viewer"),rootMargin:"-1px 0px -99% 0px"},n=new IntersectionObserver(e,t),o=new Map,s=document.querySelector(".md_core_viewer").querySelectorAll(".md_viewer > h1, h2, h3, h4, h5"),a=document.querySelector(".tag").querySelectorAll(".item > h1, h2, h3, h4, h5");console.log(`el_contents=${s.length}/${JSON.stringify(s)}`),console.log(`el_toc=${a.length}/${JSON.stringify(a)}`),s.forEach(((e,t)=>{n.observe(e),o.set(a.item(t),e),o.set(e,a.item(t))})),i.tocMap=o,i.observer=n}(),s(o.state.obj.position)}),250)})),A((()=>o.state.ObjTag),((e,t)=>{!function(e){const t=(e,t)=>{console.log(`tag=${e}, num=${t}`);const o=n.value,i=o.querySelectorAll(".md_core_viewer > h"+e);o.scrollTop=i[t].getBoundingClientRect().top-o.getBoundingClientRect().top+o.scrollTop},o=()=>{setTimeout((()=>{i.isScrolled=!1}),1e3)};console.log(`[jump_cursor]ObjTag={${Object.values(e)}}`);const s=e.tag,a=e.num;e.line,t(s,a),o()}(e)})),A((()=>e.isActive_preview),((e,t)=>{console.log(`[watch](editor_toggle)-${e}`),i.isScrolled=!1})),V((()=>n.value.querySelector(".md_core_viewer")));const s=e=>{console.log(`[v-set]value=${JSON.stringify(e)}`);const t=n.value;if(null==e)return void(t.scrollTop=0);const o=e.top/e.height;console.log(`per=${o}`),console.log(`scrollTop=${t.scrollTop}, scrollHeight=${t.scrollHeight}`),t.scrollTop=t.scrollHeight*o},a=V((()=>Y(o.state.code))),l=V((()=>o.state.height+"px"));return{status:status,Markdown:a,HeightEx:l,md_viewer:n,get_position:()=>{const e=n.value,t={top:e.scrollTop,height:e.scrollHeight,scrolled:i.isScrolled};return o.do_cmd("update_position",t),t},set_position:s}}});x("data-v-05199a28");const pt=["innerHTML"];$(),gt.render=function(e,t,n,o,i,s){return E(),C("div",{class:"md_core_viewer note",innerHTML:e.Markdown,style:N({height:e.HeightEx}),ref:"md_viewer"},null,12,pt)},gt.__scopeId="data-v-05199a28";var _t=k({components:{MarkdownEditor:mt,MarkdownViewer:gt},props:{editor_toggle:{type:Boolean,default:!0}},setup(e,t){const n=R(),o=R(),i=m({isActive_preview:!0});A((()=>e.editor_toggle),((e,t)=>{console.log(`[watch](editor_toggle)-${e}`),a()})),F((()=>{console.log("[mounted]"),document.addEventListener("keydown",s)})),G((()=>{document.removeEventListener("keydown",s)}));const s=e=>83===e.keyCode&&e.ctrlKey?(e.preventDefault(),console.log("save"),void a()):69===e.keyCode&&e.ctrlKey?(e.preventDefault(),console.log("toggle"),void a()):void 0,a=()=>{var e;const t=i.isActive_preview?{now:n,next:o}:{now:o,next:n},s=null==(e=t.now.value)?void 0:e.get_position();console.log(`isActive_preview=${i.isActive_preview}, scrollIndo=${JSON.stringify(s)}`),i.isActive_preview=!i.isActive_preview,setTimeout((()=>{var e;null==(e=t.next.value)||e.set_position(s)}),500)};return{state:i,MdViewer:n,MdEditor:o}}});_t.render=function(e,t,n,o,i,s){const a=w("MarkdownViewer"),l=w("MarkdownEditor");return E(),C("div",null,[e.state.isActive_preview?(E(),y(a,{key:0,class:"md_viewer",ref:"MdViewer",isActive_preview:e.state.isActive_preview},null,8,["isActive_preview"])):(E(),y(l,{key:1,class:"md_editor",ref:"MdEditor",isActive_preview:e.state.isActive_preview},null,8,["isActive_preview"]))])};var bt=k({emits:["event_callback"],setup(e,t){const{store_dlg:n}=Me(),{store_data:o}=xe(),i=m({title:"",edit:"",edit_org:"",check:0,title2:"",isShowDlg:!1,isNoEdit:!1,isFileOpen:!1,isReadOnly:!1,isDisabled:!0,isCheck:!1,action:()=>{},isMulti:!1});A((()=>n.state.objParam),(e=>{s(e)}));const s=e=>{const t=(e,t=!1)=>null!=e?e:t;console.log("[onChanged_objParam]"),i.title=e.title,i.title2=e.title2,i.edit=e.edit,i.edit_org=t(e.edit_org,e.edit),i.check=0,i.isShowDlg=!0,i.isNoEdit=t(e.isNoEdit),i.isFileOpen=t(e.isFileOpen),i.isReadOnly=t(e.isReadOnly),i.isCheck=t(e.isCheck),i.isMulti=t(e.isMulti),i.isDisabled=!0,i.action=e.action,l(!0)},a=e=>{if(console.log(`[doAction] flg=${e}, edit=${i.edit}`),e){const e=i.action(i);o.do_cmd(e[0],e[1],e[2])}i.isShowDlg=!1,l(!1)},l=e=>{1==e?document.addEventListener("keydown",c):document.removeEventListener("keydown",c)},c=e=>{if(27===e.keyCode)return e.preventDefault(),void a(!1)};return{state:i,props:e,doAction:a,onFileChange:e=>{const t=(e.target.files||e.dataTransfer.files)[0],n=i.action(i);o.do_cmd(n[0],t),i.isShowDlg=!1,l(!1)},isDisabled:()=>{const e=i.edit_org,t=i.edit==e&&!i.isReadOnly;return console.log(`[isDisabled]=${t}`),t}}}});x("data-v-2041bfb8");const vt={class:"modal-mask"},ft={class:"modal-wrapper"},kt={class:"modal-container"},wt={class:"header"},yt={ref:"form",class:"form"},Et=["disabled"],xt=["disabled"],$t={class:"modal-actions"},Ct=["disabled"];$(),bt.render=function(e,t,n,o,i,s){const a=w("fa");return z((E(),y(X,{persistent:""},{default:P((()=>[I("div",vt,[I("div",ft,[I("div",kt,[I("div",wt,O(e.state.title)+"?",1),I("form",yt,[1==e.state.isFileOpen?(E(),C("input",{key:0,class:"input",type:"file",onChange:t[0]||(t[0]=(...t)=>e.onFileChange&&e.onFileChange(...t))},null,32)):j("",!0),0==e.state.isNoEdit?(E(),C(L,{key:1},[1==e.state.isMulti?z((E(),C("textarea",{key:0,class:"input",_autofocus:"","onUpdate:modelValue":t[1]||(t[1]=t=>e.state.edit=t),disabled:e.state.isReadOnly},null,8,Et)),[[Z,e.state.edit]]):z((E(),C("input",{key:1,class:"input",type:"search",autofocus:"","onUpdate:modelValue":t[2]||(t[2]=t=>e.state.edit=t),disabled:e.state.isReadOnly},null,8,xt)),[[Z,e.state.edit]])],64)):j("",!0),1==e.state.isCheck?(E(),C(L,{key:2},[z(I("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=t=>e.state.check=t)},null,512),[[Q,e.state.check]]),S(" "+O(e.state.title2),1)],64)):j("",!0)],512),I("div",$t,[I("button",{class:"btn btn-ok",ref:"ok",disabled:e.isDisabled(),onClick:t[4]||(t[4]=t=>e.doAction(!0))},[M(a,{icon:"check"}),S(" "+O(e.state.title),1)],8,Ct),I("button",{class:"btn btn-can",onClick:t[5]||(t[5]=t=>e.doAction(!1))},"cancel")])])])])])),_:1},512)),[[W,e.state.isShowDlg]])},bt.__scopeId="data-v-2041bfb8";var Mt=k({components:{Appbar:qe,PreviewMd:_t,ListFile:et,ListTag:ot,CmnDlg:bt},setup(e,t){const{store_data:n}=xe(),{store_dlg:o}=Me(),i=v(),s=f(),a={snackbar:!1,message:"",timeout:-1,color:"green",actions:()=>{console.log("sb_actions")}},l=m({editor_toggle:!1,height:window.innerHeight-45,objDlgCmn:void 0,objDlgConf:void 0,snackbar_ex:a,toggle_list:!1});F((()=>{console.log("[mounted]"),c(),window.addEventListener("resize",r),document.body.style.overflow="hidden"})),G((()=>{console.log("unmounted!"),window.removeEventListener("resize",r)}));const c=()=>{console.log("init");const e=s.path.substring(1);n.do_cmd("filter_menu",null),console.log(`filename=${e}`),null==e||""==e?n.do_cmd("restore_file",""):n.do_cmd("open_file",e),r()},r=()=>{const e=window.innerHeight-45;console.log(`height=${e}`),n.update_height(e)};return{state:l,event_callback:async(e,t)=>{switch(console.log(`[event_callback] cmd=${e}, va0=${t}`),e){case"toggle_editor":l.editor_toggle=!l.editor_toggle;break;case"openSnackbar":case"onClick_snackbar":break;case"config":l.objDlgConf={cmd:e,filename:"",commit:""};break;case"print":const s=i.resolve({path:`/print/${n.filename}`});window.open(s.href,"_blank");break;case"filelist":console.log("@@"),document.querySelector(".col-3");const a=!l.toggle_list;l.toggle_list=a,console.log(l.toggle_list);break;default:if(-1!=e.indexOf("dlg_")){const i=Object.assign({},function(e,t){const o=Je[e],i=null!=t?t:n.state.filename;return o.init(o,i),o}(e,t));o.update_param(i)}else n.do_cmd(e,t)}}}}});x("data-v-12732ce5");const St={class:"container"},Ot={class:"main"};$(),Mt.render=function(e,t,n,o,i,s){const a=w("Appbar"),l=w("CmnDlg"),c=w("ListFile"),r=w("PreviewMd"),d=w("ListTag");return E(),C("div",St,[M(a,{ref:"appbar",onEvent_callback:e.event_callback},null,8,["onEvent_callback"]),M(l,{objParam:e.state.objDlgCmn,onEvent_callback:e.event_callback},null,8,["objParam","onEvent_callback"]),I("div",Ot,[e.state.toggle_list?(E(),y(c,{key:0,class:"col-3",onEvent_callback:e.event_callback,style:N({height:e.state.height+"px"})},null,8,["onEvent_callback","style"])):j("",!0),M(r,{class:"col-2",ref:"pane",editor_toggle:e.state.editor_toggle,style:N({height:e.state.height+"px"})},null,8,["editor_toggle","style"]),M(d,{class:"col-1",onEvent_callback:e.event_callback,style:N({height:e.state.height+"px"})},null,8,["onEvent_callback","style"])])])},Mt.__scopeId="data-v-12732ce5";var jt=k({components:{MarkdownViewer:gt},setup(e,t){const{store_data:n}=xe(),o=f(),i=m({filename:"",height:window.innerHeight,timer3:-1});F((()=>{console.log("[mounted]"),s(),document.body.style.overflow="hidden"}));const s=()=>{console.log("init");const e=o.params.pathMatch;console.log(`filename=${e}`),null==e||""==e?n.get_filename():n.update_filename(e),i.filename=e,i.timer3=window.setTimeout((()=>{clearTimeout(i.timer3),window.print()}),500)};return{state:i}}});const Lt={_class:"container"};jt.render=function(e,t,n,o,i,s){const a=w("MarkdownViewer");return E(),C("div",Lt,[S(O(e.state.filename)+" ",1),M(a,{class:"md_viewer",_ref:"MdViewer",style:{"{\n          height":"initial"}})])};const Tt=[{name:"viewer",path:"/:pathMatch(.*)*",component:Mt},{name:"viewer_print",path:"/print/:pathMatch(.*)",component:jt}],Dt=ee({history:te(),routes:Tt});!function(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:i,onRegisterError:s}=e;let a;"serviceWorker"in navigator&&(a=new ne("./sw.js",{scope:"./"}),a.addEventListener("activated",(e=>{e.isUpdate?window.location.reload():null==o||o()})),a.register({immediate:t}).then((e=>{null==i||i(e)})).catch((e=>{null==s||s(e)})))}(),oe.add(ie),se(Se).use(Dt).provide(ke,(()=>{console.log("init authStore");const e=m({isLoggedin:!1,displayName:"hoge",photoURL:"",uid:""}),t=i(),n=t=>{var n,o,i;e.isLoggedin=!!t,t&&(e.displayName=null!=(n=t.displayName)?n:"",e.photoURL=null!=(o=t.photoURL)?o:"",e.uid=null!=(i=t.uid)?i:"")};return p(t,(e=>{console.log(e),n(e)})),{state_auth:e,setUser:n,signin:()=>{const e=new h;g(t,e).then((e=>{h.credentialFromResult(e).accessToken,e.user})).catch((e=>{e.code,e.message,e.email,h.credentialFromError(e)}))},signout:()=>t.signOut(),updateUser:e=>{var o;null==(o=t.currentUser)||o.updateProfile(e).then((()=>n(t.currentUser)))}}})()).component("fa",ae).mount("#app");
